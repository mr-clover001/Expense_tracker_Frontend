(function(g){var window=this;'use strict';var IOO=function(U){var Y=new g.Pz("und",new g.Gp("Default","und",!0));Y.captionTracks=U.captionTracks;return Y},u$L=function(U){return new g.tS(function(Y,A){var c=U.length,d=[];
if(c)for(var T=function(l,P){c--;d[l]=P;c==0&&Y(d)},E=function(l){A(l)},L,r=0;r<U.length;r++)L=U[r],g.nWl(L,g.EO(T,r),E);
else Y(d)})},hN=function(U){this.Y=U},Sq=function(){hN.apply(this,arguments)},K$Y=function(){Sq.apply(this,arguments)},qRL=function(){Sq.apply(this,arguments)},Caz=function(){Sq.apply(this,arguments)},UUo=function(){Sq.apply(this,arguments)},YTz=function(){Sq.apply(this,arguments)},AYw=function(){Sq.apply(this,arguments)},cYF=function(){hN.apply(this,arguments)},dUL=function(){Sq.apply(this,arguments)},Tcq=function(){Sq.apply(this,arguments)},E3j=function(){Sq.apply(this,arguments)},o3o=function(){Sq.apply(this,
arguments)},zTY=function(){Sq.apply(this,arguments)},Luf=function(){Sq.apply(this,arguments)},rYL=function(){Sq.apply(this,arguments)},ldo=function(){Sq.apply(this,arguments)},PYz=function(){Sq.apply(this,arguments)},Vyz=function(){Sq.apply(this,arguments)},$Uo=function(){Sq.apply(this,arguments)},v3q=function(){Sq.apply(this,arguments)},HLO=function(){hN.apply(this,arguments)},GtF=function(){Sq.apply(this,arguments)},WuW=function(){Sq.apply(this,arguments)},wrT=function(){Sq.apply(this,arguments)},
iLw=function(){Sq.apply(this,arguments)},JYo=function(){Sq.apply(this,arguments)},Fuo=function(){Sq.apply(this,arguments)},jDz=function(){Sq.apply(this,arguments)},Nco=function(){Sq.apply(this,arguments)},tyz=function(){Sq.apply(this,arguments)},eTI=function(){hN.apply(this,arguments)},Bcf=function(){hN.apply(this,arguments)},Xrm=function(){hN.apply(this,arguments)},ktz=function(){Sq.apply(this,arguments)},RTI=function(){Sq.apply(this,arguments)},adf=function(){Sq.apply(this,arguments)},xUY=function(){Sq.apply(this,
arguments)},sDq=function(){Sq.apply(this,arguments)},fdo=function(){Sq.apply(this,arguments)},hTT=function(){Sq.apply(this,arguments)},STL=function(){Sq.apply(this,arguments)},Myw=function(){Sq.apply(this,arguments)},bLT=function(){Sq.apply(this,arguments)},prz=function(){Sq.apply(this,arguments)},QDT=function(){Sq.apply(this,arguments)},ZLL=function(){Sq.apply(this,arguments)},OLj=function(){Sq.apply(this,arguments)},mUO=function(){Sq.apply(this,arguments)},g3z=function(){Sq.apply(this,arguments)},
yYf=function(){Sq.apply(this,arguments)},n3z=function(){Sq.apply(this,arguments)},DUq=function(){Sq.apply(this,arguments)},Idz=function(){Sq.apply(this,arguments)},uMW=function(){Sq.apply(this,arguments)},KuY=function(){Sq.apply(this,arguments)},qTT=function(){Sq.apply(this,arguments)},CYq=function(){Sq.apply(this,arguments)},U3j=function(){Sq.apply(this,arguments)},YgY=function(){Sq.apply(this,arguments)},ASw=function(){hN.apply(this,arguments)},cSz=function(){Sq.apply(this,arguments)},d3Y=function(){Sq.apply(this,
arguments)},T9O=function(){Sq.apply(this,arguments)},EMo=function(){Sq.apply(this,arguments)},oMI=function(){Sq.apply(this,arguments)},zGW=function(){Sq.apply(this,arguments)},LGf=function(){Sq.apply(this,arguments)},rSI=function(){Sq.apply(this,arguments)},lmz=function(){Sq.apply(this,arguments)},P7O=function(){Sq.apply(this,arguments)},VWw=function(){Sq.apply(this,arguments)},$3w=function(){Sq.apply(this,arguments)},vMT=function(){Sq.apply(this,arguments)},Hez=function(){Sq.apply(this,arguments)},
Gcm=function(){Sq.apply(this,arguments)},WGq=function(){Sq.apply(this,arguments)},wOW=function(){Sq.apply(this,arguments)},ieF=function(){Sq.apply(this,arguments)},JSL=function(){Sq.apply(this,arguments)},FGw=function(){Sq.apply(this,arguments)},jzW=function(){Sq.apply(this,arguments)},N9m=function(){Sq.apply(this,arguments)},tWO=function(){Sq.apply(this,arguments)},eGw=function(){Sq.apply(this,arguments)},B9o=function(){Sq.apply(this,arguments)},XOo=function(){Sq.apply(this,arguments)},kcI=function(){Sq.apply(this,
arguments)},RGz=function(){Sq.apply(this,arguments)},amL=function(){Sq.apply(this,arguments)},x3o=function(){Sq.apply(this,arguments)},szT=function(){Sq.apply(this,arguments)},fmw=function(){Sq.apply(this,arguments)},hGO=function(U){U=U.key||U.id;
if(!U)throw Error("Entity key is missing");return U},Sgz=function(){if(M$)return M$();
var U={};M$=g.YF("PersistentEntityStoreDb",{fR:(U.EntityStore={Os:1},U.EntityAssociationStore={Os:2},U),shared:!1,upgrade:function(Y,A){A(1)&&g.SA(g.k6(Y,"EntityStore",{keyPath:"key"}),"entityType","entityType");A(2)&&(Y=g.k6(Y,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.SA(Y,"byParentEntityKey","parentEntityKey"),g.SA(Y,"byChildEntityKey","childEntityKey"))},
version:3});return M$()},MWO=function(U){return g.g7(Sgz(),U)},beL=function(U){return g.g7((0,g.FkY)(),U)},b_=function(U){this.token=U},pt=function(U,Y){Y=Y===void 0?{}:Y;
g.Do.call(this,g.jwY[U],Object.assign({},{name:"PESEncoderError",type:U},Y));this.type=U;this.level="WARNING";Object.setPrototypeOf(this,pt.prototype)},pOF=function(U){return new pt("WRONG_DATA_TYPE",{WP:U})},Qzf=function(U){return U instanceof Error?new pt("UNKNOWN_ENCODE_ERROR",{originalMessage:U.message}):new pt("UNKNOWN_ENCODE_ERROR")},ZeO=function(U){return U instanceof Error?new pt("UNKNOWN_DECODE_ERROR",{originalMessage:U.message}):new pt("UNKNOWN_DECODE_ERROR")},OeF=function(U,Y){U=U instanceof
pt?U:Y(U);
g.S5(U);throw U;},m3O=function(){},gMw=function(U,Y,A){try{return U.W(Y,A)}catch(c){OeF(c,Qzf)}},ySI=function(U){U=(new TextEncoder).encode(U).subarray(0,16);
var Y=new Uint8Array(16);Y.set(U);return Y},Q3=function(U){this.Y=U},D3f=function(U){var Y=nMO[U];
if(Y)return Y;g.Md(new g.Do("Entity model not found.",{entityType:U}))},ImF=function(U,Y){this.Y=U;
this.T=Y;this.W={}},KGj=function(U,Y){a:{U=uDw(U.T,Y.version);
try{var A=U.T(Y.data,Y.key);break a}catch(c){OeF(c,ZeO)}A=void 0}return A},Zv=function(U,Y,A){return U.Y.objectStore("EntityStore").get(Y).then(function(c){if(c){if(A&&c.entityType!==A)throw Error("Incorrect entity type");
return KGj(U,c)}})},OK=function(U,Y,A){return A?(A=A.map(function(c){return Zv(U,c,Y)}),g.NC.all(A)):U.Y.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(Y)).then(function(c){return c.map(function(d){return KGj(U,d)})})},g0=function(U,Y,A){var c=hGO(Y),d=uDw(U.T,1),T=Object.assign({},Y);
return U.Y.objectStore("EntityStore").get(c).then(function(E){if(E){if(E.entityType!==A)throw Error("Incorrect entity type");T.entityMetadata||(E=KGj(U,E),T.entityMetadata=E.entityMetadata)}}).then(function(){var E={key:c,
entityType:A,data:gMw(d,T,c),version:1};return g.NC.all([g.x6(U.Y.objectStore("EntityStore"),E),qgO(U,T,A)])}).then(function(){mE(U,c,A);
return c})},C7o=function(U,Y,A){Y=Y.map(function(c){return g0(U,c,A)});
return g.NC.all(Y)},y3=function(U,Y,A){if(A==null?0:A.fD){var c=new Set;
return U7T(U,Y,c).then(function(){for(var T=[],E=g.J(c),L=E.next();!L.done;L=E.next())T.push(y3(U,L.value));return g.NC.all(T).then(function(){})})}var d=g.Uk(Y).entityType;
return g.NC.all([U.Y.objectStore("EntityStore").delete(Y),Yvj(U,Y)]).then(function(){mE(U,Y,d)})},Ajo=function(U,Y){return g.Qb(U.Y.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(Y)},function(A){return g.NC.all([A.delete(),
Yvj(U,A.cursor.primaryKey)]).then(function(){mE(U,A.cursor.primaryKey,Y);return g.bW(A)})})},cjw=function(U,Y,A,c){var d=uDw(U.T,1);
return Zv(U,Y,c).then(function(T){if(T){T=g.ww(T,A);var E={key:Y,entityType:c,data:gMw(d,T,Y),version:1};return g.NC.all([g.x6(U.Y.objectStore("EntityStore"),E),qgO(U,T,c)])}}).then(function(){mE(U,Y,c);
return Y})},mE=function(U,Y,A){var c=U.W[A];
c||(c=new Set,U.W[A]=c);c.add(Y)},d7w=function(U,Y,A){var c=hGO(Y);
A=D3f(A);if(!A)return g.NC.resolve([]);A=new A(Y);U=U.Y.objectStore("EntityAssociationStore");Y=[];A=g.J(A.T());for(var d=A.next();!d.done;d=A.next())Y.push(g.x6(U,{parentEntityKey:c,childEntityKey:d.value}));return g.NC.all(Y).then(function(T){return T.map(function(E){return E[1]})})},Yvj=function(U,Y){return U.Y.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(Y))},qgO=function(U,Y,A){var c=hGO(Y);
return Yvj(U,c).then(function(){return d7w(U,Y,A)})},U7T=function(U,Y,A){if(A.has(Y))return g.NC.resolve(void 0);
A.add(Y);return Tpo(U,Y).then(function(c){return U.Y.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(Y)).then(function(){return c})}).then(function(c){var d=g.NC.resolve(void 0);
c=g.J(c);for(var T=c.next(),E={};!T.done;E={by:void 0},T=c.next())E.by=T.value,d=d.then(function(L){return function(){return U7T(U,L.by,A)}}(E));
return d}).then(function(){})},Tpo=function(U,Y){var A=U.Y.objectStore("EntityAssociationStore");
return A.index("byParentEntityKey").getAll(IDBKeyRange.only(Y)).then(function(c){var d=[];c=g.J(c);for(var T=c.next();!T.done;T=c.next())T=T.value,d.push(A.index("byChildEntityKey").getAll(T.childEntityKey));return g.NC.all(d)}).then(function(c){var d=[];
c=g.J(c);for(var T=c.next();!T.done;T=c.next())T=T.value,T.length===1&&d.push(T[0].childEntityKey);return d})},nt=function(){},EUT=function(){this.Y={};
this.Y[0]=new nt;if(!g.ir("aes_pes_encoder_killswitch")){var U=this.Y;try{var Y=g.Ib();var A=ySI(Y);var c=new Q3(new g.BR(A),new g.ew(A))}catch(d){throw U=d instanceof Error?new pt("KEY_CREATION_FAILED",{originalMessage:d.message}):new pt("KEY_CREATION_FAILED"),g.S5(U),U;}U[1]=c}},uDw=function(U,Y){Y=Y===void 0?0:Y;
U=U.Y[Y];if(!U)throw Y=new pt("INVALID_ENCODER_VERSION",{WP:Y}),g.S5(Y),Y;return U},Dv=function(U,Y){g.p.call(this);
this.token=U;this.Y=Y;this.observers=[];U=new g.Dc.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.Ib());U.onmessage=this.T.bind(this);this.channel=U},IA=function(U,Y,A){var c,d,T,E;
return g.S(function(L){if(L.T==1)return g.x(L,MWO(U.token),2);if(L.T!=3)return c=L.Y,g.x(L,g.aE(c,["EntityStore","EntityAssociationStore"],Y,function(r){d=new ImF(r,U.Y);return A(d)}),3);
T=L.Y;d&&(E=d.W,Object.keys(E).length>0&&(U.channel.postMessage(E),oUY(U,E)));return L.return(T)})},u_=function(U,Y,A){return IA(U,{mode:"readwrite",
kt:!0},function(c){return g0(c,Y,A)})},zNo=function(U,Y){return IA(U,{mode:"readwrite",
kt:!0},function(A){return C7o(A,Y,"offlineOrchestrationActionWrapperEntity")})},L3w=function(U,Y){return IA(U,{mode:"readwrite",
kt:!0},function(A){return y3(A,Y)})},rjY=function(U){return IA(U,{mode:"readwrite",
kt:!0},function(Y){return Ajo(Y,"videoPlaybackPositionEntity")})},Kt=function(U,Y,A){return IA(U,{mode:"readonly",
kt:!0},function(c){return Zv(c,Y,A)})},q$=function(U,Y,A){return IA(U,{mode:"readonly",
kt:!0},function(c){return OK(c,Y,A)})},oUY=function(U,Y){U=g.J(U.observers);
for(var A=U.next();!A.done;A=U.next())A=A.value,A(Y)},l_W=function(){var U,Y,A;
return g.S(function(c){if(c.T==1)return g.J3(c,2),g.x(c,g.Cg(),4);if(c.T!=2){U=c.Y;if(!U||!g.uH()||typeof g.Dc.BroadcastChannel==="undefined")return c.return();Y=new EUT;return c.return(new Dv(U,Y))}A=g.XE(c);A instanceof Error&&g.S5(A);return c.return()})},Ct=function(){PFI||(PFI=l_W());
return PFI},VJF=function(U){var Y;
U=(Y=U.options)==null?void 0:Y.persistenceOption;return U==="ENTITY_PERSISTENCE_OPTION_PERSIST"||U==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},$7F=function(U){var Y;
return g.S(function(A){return A.T==1?g.x(A,Ct(),2):(Y=A.Y)?g.x(A,IA(Y,"readwrite",function(c){for(var d={},T=g.J(U),E=T.next(),L={};!E.done;L={p5:void 0,Ln:void 0},E=T.next())L.p5=E.value,L.p5.entityKey&&VJF(L.p5)&&(L.Ln=g.gL(L.p5.payload),E=void 0,L.p5.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(E=function(r){return function(){return g0(c,r.p5.payload[r.Ln],r.Ln)}}(L)),L.p5.type==="ENTITY_MUTATION_TYPE_DELETE"&&(E=function(r){return function(){return y3(c,r.p5.entityKey)}}(L)),L.p5.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(E=function(r){return function(){return cjw(c,r.p5.entityKey,r.p5.payload[r.Ln],r.Ln)}}(L)),E&&(d[L.p5.entityKey]=d[L.p5.entityKey]?d[L.p5.entityKey].then(E):E()));
return g.NC.all(Object.values(d))}),0):A.return()})},vUf=function(U){var Y;
return g.S(function(A){if(A.T==1){Y=U.mutations;if(!Y||Y.length<=0)return A.return();if(g.dS){var c={type:"ENTITY_LOADED"};Y!==void 0&&(c.payload=Y);g.dS.dispatch(c)}return g.x(A,$7F(Y),2)}Y.length=0;g.i8(A)})},H_z=function(U){return U!==void 0},GzI=function(U){var Y=g.a$();
Y=Object.assign({},Y);U=Object.assign({},U);for(var A in Y)U[A]?(Y[A]!==4&&(Y[A]=U[A]),delete U[A]):Y[A]!==2&&(Y[A]=4);Object.assign(Y,U);g.orX(Y);JSON.stringify(Y);return Y},W3W=function(U){var Y,A;
return g.S(function(c){if(c.T==1)return g.x(c,g.Cg(),2);if(c.T!=3)return(Y=c.Y)?g.x(c,g.fD(Y),3):c.return();A=c.Y;return c.return(g.aE(A,["index","media","captions"],{mode:"readwrite",kt:!0},function(d){var T=IDBKeyRange.bound(U+"|",U+"~");d=[d.objectStore("index").delete(T),d.objectStore("media").delete(T),d.objectStore("captions").delete(T)];return g.NC.all(d).then(function(){})}))})},wLz=function(){var U,Y;
return g.S(function(A){if(A.T==1)return g.x(A,g.Cg(),2);if(A.T!=3){U=A.Y;if(!U)throw g.F4("rvdfd");return g.x(A,g.fD(U),3)}Y=A.Y;return A.return(g.aE(Y,["index","media"],{mode:"readwrite",kt:!0},function(c){var d={};return g.MC(c.objectStore("index"),{},function(T){var E=T.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),L=g.NC.resolve(void 0);if(E){var r=E[1];E=E[2];d[r]=d[r]||{};var l;d[r][E]=g.Pd3((l=T.getValue())==null?void 0:l.fmts)}else L=T.delete().then(function(){});
return g.NC.all([g.bW(T),L]).then(function(P){return g.J(P).next().value})}).then(function(){for(var T={},E=g.J(Object.keys(d)),L=E.next();!L.done;L=E.next()){L=L.value;
var r=d[L].v;T[L]=d[L].a&&r?1:2}var l=GzI(T);return g.kxE(c.objectStore("media"),{},function(P){var V=P.cursor.key.match(g.HAY);V&&T[V[1]]||c.objectStore("media").delete(P.cursor.key);return g.iZ8(P)}).then(function(){return l})})}))})},i_o=function(U,Y){var A,c;
return g.S(function(d){if(d.T==1)return g.x(d,g.Cg(),2);if(d.T!=3){A=d.Y;if(!A)throw g.F4("wct");return g.x(d,g.fD(A),3)}c=d.Y;return g.x(d,g.aE(c,["captions"],{mode:"readwrite",kt:!0},function(T){var E=[];T=T.objectStore("captions");for(var L=0;L<Y.length;L++){var r=g.x6(T,Y[L],U+"|"+Y[L].metadata.vss_id);E.push(r)}return g.NC.all(E)}),0)})},Jjz=function(U){var Y,A,c;
return g.S(function(d){if(d.T==1)return Y=IDBKeyRange.bound(U+"|",U+"~"),g.x(d,g.Cg(),2);if(d.T!=3){A=d.Y;if(!A)throw g.F4("gactfv");return g.x(d,g.fD(A),3)}c=d.Y;return d.return(c.getAll("captions",Y))})},F3o=function(U){return g.S(function(Y){g.sJ(U,0);
return Y.return(W3W(U))})},j_z=function(U){return{context:g.CV(),
videoIds:U}},NpY=function(U){return{context:g.CV(),
playlistIds:U}},tJT=function(U){return{context:g.CV(),
offlinePlaylistSyncChecks:U}},eNj=function(){this.Y=new Map},XLT=function(){Bpj||(Bpj=new eNj);
return Bpj},kzq=function(U,Y){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:U},metadata:Y,statusCode:void 0,csn:void 0,can:void 0}},RNo=function(U,Y,A){if(!A){var c=c===void 0?!1:c;
A=U.Y.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!A||c)A=g.tH(16),U.Y.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",A)}U={flowNonce:A,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:Y.eventType};Y.metadata&&(U.flowMetadata=Y.metadata);Y.statusCode!==void 0&&(U.flowEventStatus=Y.statusCode);Y.csn&&(U.csn=Y.csn);Y.can&&(U.can=Y.can);g.r7("flowEvent",U,void 0)},a_Y=function(U){var Y,A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL;
return g.S(function(Rm){if(Rm.T==1)return g.x(Rm,IA(U,{mode:"readonly",kt:!0},function(vW){return OK(vW,"playbackData").then(function(b8){var hq=b8.map(function(a){return a.transfer}).filter(function(a){return!!a}),am=b8.map(function(a){return a.offlineVideoPolicy}).filter(function(a){return!!a}),k=b8.filter(function(a){return!!a.key}).map(function(a){return g.YX(g.Uk(a.key).entityId,"downloadStatusEntity")});
hq=OK(vW,"transfer",hq);am=OK(vW,"offlineVideoPolicy",am);k=OK(vW,"downloadStatusEntity",k);var R=hq.then(function(a){a=a.reduce(function(b,m){(m==null?0:m.offlineVideoStreams)&&b.push.apply(b,g.X(m.offlineVideoStreams));return b},[]).filter(function(b){return!!b});
return OK(vW,"offlineVideoStreams",a)});
return g.NC.all([hq,am,R,k]).then(function(a){var b=g.J(a);a=b.next().value;var m=b.next().value;var N4=b.next().value;b=b.next().value;return[b8,a,m,N4,b]})})}),2);
if(Rm.T!=3)return Y=Rm.Y,g.x(Rm,IA(U,{mode:"readonly",kt:!0},function(vW){return OK(vW,"mainDownloadsListEntity").then(function(b8){var hq,am;return(am=(hq=b8[0])==null?void 0:hq.downloads)!=null?am:[]})}),3);
A=Rm.Y;c=g.J(Y);d=c.next().value;T=c.next().value;E=c.next().value;L=c.next().value;r=c.next().value;l=d;P=T;V=E;v=L;H=r;G={};F={};N={};e={};B={};f=[];h=g.J(P);for(Q=h.next();!Q.done;Q=h.next())(K=Q.value)&&(G[K.key]=K);D=g.J(V);for(c3=D.next();!c3.done;c3=D.next())(TV=c3.value)&&(F[TV.key]=TV);U9=g.J(H);for(LY=U9.next();!LY.done;LY=U9.next())(q=LY.value)&&(N[q.key]=q);FE=g.J(v);for(B3=FE.next();!B3.done;B3=FE.next())(O9=B3.value)&&(e[O9.key]=O9);tq=g.J(A);for(Lj=tq.next();!Lj.done;Lj=tq.next())kl=
Lj.value,eS=void 0,B[(eS=kl.videoItem)!=null?eS:""]=!0,kl.videoItem&&(t=To=void 0,zV=(t=(To=g.Uk(kl.videoItem))==null?void 0:To.entityId)!=null?t:"",f.push({externalVideoId:zV}));Im=l.filter(function(vW){if(!vW||!vW.key||!vW.offlineVideoPolicy)return!1;vW=g.Uk(vW.key).entityId;vW=g.YX(vW,"downloadStatusEntity");var b8;return!(vW&&((b8=N[vW])==null?void 0:b8.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
jL=Im.map(function(vW){var b8=G[vW.transfer],hq=[];if(b8==null?0:b8.offlineVideoStreams)for(var am=g.J(b8.offlineVideoStreams),k=am.next();!k.done;k=am.next())(k=e[k.value])&&hq.push(k);am=F[vW.offlineVideoPolicy];k=B;var R=vW==null?void 0:vW.playerResponseTimestamp,a=g.Uk(am.key).entityId;vW=g.YX(a,"mainVideoEntity");if(am.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var b="OFFLINE_VIDEO_STATE_DISABLED";am.expirationTimestamp&&Number(am.expirationTimestamp)<Date.now()/1E3&&(b="OFFLINE_VIDEO_STATE_EXPIRED")}else if(am.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")b="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(b8==null?void 0:b8.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":b="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":b="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":b="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":b="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":b="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":b="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:b="OFFLINE_VIDEO_STATE_UNKNOWN"}if(b==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(b8==null?void 0:b8.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":b="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":b="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":b=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}a={id:a,videoState:b};if(b8==null?0:b8.cotn)a.cotn=b8.cotn;if(b8==null?0:b8.maximumDownloadQuality)a.selectedVideoQuality=b8==null?void 0:b8.maximumDownloadQuality;if(b8==null?0:b8.lastProgressTimeMs)a.lastProgressTimeMs=b8.lastProgressTimeMs;R&&(a.playerResponseSavedTimeMs=String(Number(R)*1E3));b8=String;R=0;hq=g.J(hq);for(b=hq.next();!b.done;b=hq.next())if(b=b.value,b.streamsProgress){b=g.J(b.streamsProgress);for(var m=b.next();!m.done;m=b.next()){var N4=void 0;
R+=Number((N4=m.value.numBytesDownloaded)!=null?N4:0)}}a.downloadedBytes=b8(R);a.selectedOfflineMode=k[vW]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";am.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(a.offlinePlaybackDisabledReason=am.offlinePlaybackDisabledReason);return a});
return Rm.return({offlineVideos:jL,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:f}}})})},x7j=function(){this.locks=navigator.locks},s_z=function(){try{var U=g.u8("ytglobal.locks_");
if(U)return U;var Y;if(Y=navigator){var A=navigator;Y="locks"in A&&!!A.locks}if(Y)return g.Dc.localStorage&&g.Dc.localStorage.getItem("noop"),U=new x7j,g.Ic("ytglobal.locks_",U),U}catch(c){}},Um=function(){},f_w=function(){},hNj=function(U){if(U.includes(":"))throw Error("Invalid user cache name: "+U);
return U+":"+g.Ib("CacheStorage get")},SvW=function(){return g.S(function(U){if(Yd!==void 0)return U.return(Yd);
Yd=new Promise(function(Y){var A;return g.S(function(c){switch(c.T){case 1:return g.J3(c,2),g.x(c,As.open("test-only"),4);case 4:return g.x(c,As.delete("test-only"),5);case 5:g.t3(c,3);break;case 2:if(A=g.XE(c),A instanceof Error&&A.name==="SecurityError")return Y(!1),c.return();case 3:Y("caches"in window),g.i8(c)}})});
return U.return(Yd)})},b_m=function(){return g.S(function(U){if(U.T==1)return g.x(U,SvW(),2);
if(!U.Y)return U.return(void 0);MJF||(MJF=new f_w);return U.return(MJF)})},cQ=function(U,Y,A){g.Md(new g.Do("Woffle: "+U,A?{cotn:A}:""));
Y instanceof Error&&g.Md(Y)},pLY=function(U){var Y;
return g.S(function(A){if(A.T==1)return g.x(A,a_Y(U),2);Y=A.Y;g.r7("offlineStateSnapshot",Y);g.i8(A)})},di=function(U){g.p.call(this);
var Y=this;this.api=U;this.o5={mYv:function(){return Y.Y},
MrI:function(){return Y.T}};
typeof g.Dc.BroadcastChannel!=="undefined"&&(this.Y=new g.Dc.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.Ib()),this.Y.onmessage=this.W.bind(this),this.T=new g.Dc.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.Ib()),this.T.onmessage=this.j.bind(this))},Tn=function(U,Y){U.api.Ev("onOfflineOperationFailure",Y);
var A;(A=U.Y)==null||A.postMessage(Y)},Q_f=function(U,Y,A,c){var d=this;
this.Z=U;this.X=Y;this.visibility=A;this.S=c;this.K=this.G=this.J=this.W=this.Y=!1;this.j=new g.IM(function(){d.le()});
this.o5={D8:function(){return d.T},
le:function(){d.le()},
xNy:function(){return d.j}};
this.visibility.subscribe("visibilitystatechange",function(){d.Wa()})},Z_m=function(U){if(!U.W&&!U.Y){var Y=s_z();
if(Y){U.W=!0;var A=g.Ib("OfflineLockManager");Y.request("woffle_orchestration_leader:"+A,{},function(){var c,d,T,E;return g.S(function(L){switch(L.T){case 1:return g.J3(L,2),U.T=new g.VI,U.Y=!0,U.W=!1,g.x(L,U.Z(),4);case 4:return g.x(L,U.T.promise,5);case 5:g.t3(L,0);break;case 2:c=g.XE(L),((T=(d=U).S)==null?0:T.call(d,"wo_relinquish_leadership_on_lock_request_error"))||U.le(),c instanceof Error&&(E=c,E.args=[{name:"WoLockManagerError",W6:c.name}],g.S5(E)),g.i8(L)}})})}}},O_L=function(U){U.Y&&(U.K=
!0,Em(U))},m7m=function(U,Y){U.Y&&(U.J=Y,Em(U))},gUL=function(U,Y){U.Y&&(U.G=Y,Em(U))},Em=function(U){U.G&&U.J&&U.K&&U.visibility.isBackground()?g.uQ(U.j,6E4):U.j.stop()},oI=function(U){var Y;
U.offlineDeleteReason=(Y=U.offlineDeleteReason)!=null?Y:"OFFLINE_DELETE_REASON_UNKNOWN";var A;U.offlineModeType=(A=U.offlineModeType)!=null?A:"OFFLINE_NOW";g.r7("offlineDeleteEvent",U)},zn=function(U,Y){var A=Y.videoId;
var c=Y.sR;Y=Y.offlineModeType;U.encryptedVideoId=A;U.cotn=c==null?void 0:c.cotn;U.offlineabilityFormatType=c==null?void 0:c.maximumDownloadQuality;var d;U.isRefresh=(d=c==null?void 0:c.isRefresh)!=null?d:!1;var T;U.softErrorCount=(T=c==null?void 0:c.transferRetryCount)!=null?T:0;U.offlineModeType=Y!=null?Y:"OFFLINE_NOW";(U.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&U.statusType==="UNKNOWN_STATUS_TYPE"||!U.transferStatusType&&!U.statusType)&&g.Md(Error("Woffle unknown transfer status"));
g.r7("offlineTransferStatusChanged",U)},yjY=function(U){zn({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",
statusType:"ADDED_TO_QUEUE"},U)},nUO=function(U,Y,A,c){c={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!c};Y&&A&&(Y=Math.floor(Y/1024).toFixed(),A=Math.floor(A/1024).toFixed(),c.alreadyDownloadedKbytes=Y,c.totalFetchedKbytes=Y,c.totalContentKbytes=A);zn(c,U)},D7F=function(U){zn({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},U)},I_O=function(U){zn({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},U)},uJL=function(U){switch(U){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
LP=function(U){var Y,A,c;
return((c=(Y=U.actionMetadata)==null?void 0:(A=Y.retryScheduleIntervalsInSeconds)==null?void 0:A.length)!=null?c:0)>0},ri=function(U){return U.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!U.entityKey},l5=function(U){return U.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!U.entityKey},PQ=function(U){return U.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!U.entityKey},K3z=function(U){return U.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!U.entityKey},
Vs=function(U,Y,A,c,d){d=d===void 0?!1:d;
var T,E,L,r,l,P;return g.S(function(V){if(V.T==1)return T=g.YX(U,Y),E=g.YX(U,"downloadStatusEntity"),g.x(V,IA(A,{mode:"readonly",kt:!0},function(v){return g.NC.all([Zv(v,T,Y),Zv(v,E,"downloadStatusEntity")])}),2);
L=V.Y;r=L.length?L[0]:void 0;if(!r)return V.uY(0);l=qvm;if(P=L.length>1?L[1]:void 0){if(P.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!d)return V.return();P.downloadState=c}else P={key:E,downloadState:c};g.OZ(r,l,P);return g.x(V,IA(A,{mode:"readwrite",kt:!0},function(v){return g.NC.all([g0(v,r,Y),g0(v,P,"downloadStatusEntity")])}),0)})},$d=function(U,Y){return U.actionType===Y.actionType&&U.entityKey===Y.entityKey},vQ=function(U,Y){if(U&&U.transferState!=="TRANSFER_STATE_COMPLETE"&&U.transferState!==
"TRANSFER_STATE_FAILED"){var A=g.Uk(U.key).entityId;
zn({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:A,sR:U,offlineModeType:Y})}},HQ=function(U){if(!U||!U.thumbnails)return[];
var Y=[];U=g.J(U.thumbnails);for(var A=U.next();!A.done;A=U.next())A=A.value,A.url&&Y.push(A.url);return Y},CFW=function(U,Y,A){A=A===void 0?[]:A;
var c,d,T,E,L,r,l,P,V,v,H,G,F;return g.S(function(N){if(N.T==1)return A.length?g.x(N,q$(U,Y),2):N.return([]);c=N.Y;d=new Set;T=g.J(c);for(E=T.next();!E.done;E=T.next())if(L=E.value,r=L.id||L.key)l=g.Uk(r).entityId,d.add(l);P=[];V=g.J(A);for(v=V.next();!v.done;v=V.next())H=v.value,G=H.offlineVideoData,F=void 0,((F=G)==null?0:F.videoId)&&!d.has(G.videoId)&&P.push(H);return N.return(P)})},Uvz=function(U,Y,A){return new g.nD(U,{cotn:Y,
raw_player_response:A,download_media:!0,start:Infinity,disable_watch_next:!0})},YAf=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},Gn=function(U,Y,A,c,d,T,E,L,r,l,P){this.entityType=U;
this.actionId=Y;this.action=A;this.parentActionId=c;this.rootActionId=d===void 0?Y:d;this.childActionIds=T;this.prereqActionId=E;this.postreqActionIds=L;this.hasChildActionFailed=l;this.retryScheduleIndex=0;this.Y=P||Date.now();this.retryScheduleIndex=r||0},WQ=function(U){if(!U.key)throw Error("Entity key is required.");
if(!U.actionProto)throw Error("OfflineOrchestrationAction is required.");var Y=g.Uk(U.key),A=g.Uk(U.actionProto.entityKey);return new Gn(A.entityType,Y.entityId,U.actionProto,U.parentActionId,U.rootActionId,U.childActionIds,U.prereqActionId,U.postreqActionIds,U.retryScheduleIndex,U.hasChildActionFailed,Number(U.enqueueTimeSec)*1E3)},wi=function(U){return{key:g.YX(U.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:U.action,parentActionId:U.parentActionId,rootActionId:U.rootActionId,childActionIds:U.childActionIds,prereqActionId:U.prereqActionId,postreqActionIds:U.postreqActionIds,retryScheduleIndex:U.retryScheduleIndex,hasChildActionFailed:U.hasChildActionFailed,enqueueTimeSec:(U.Y/1E3).toFixed()}},AZW=function(){var U;
return g.S(function(Y){return Y.T==1?g.x(Y,b_m(),2):(U=Y.Y)?Y.return(U.delete("yt-player-local-img")):Y.return(!0)})},i5=function(U){var Y,A;
return g.S(function(c){if(c.T==1)return g.x(c,b_m(),2);if(c.T!=3){Y=c.Y;if(!Y)throw Error("Cache API not supported");return U.length?g.x(c,Y.open("yt-player-local-img"),3):c.return()}A=c.Y;return g.x(c,Promise.all(U.map(function(d){return A.delete(d)})),0)})},Js=function(U){var Y,A;
return g.S(function(c){if(c.T==1)return g.x(c,b_m(),2);if(c.T!=3){Y=c.Y;if(!Y)throw Error("Cache API not supported");return U.length?g.x(c,Y.open("yt-player-local-img"),3):c.return()}A=c.Y;return g.x(c,A.addAll(U),0)})},Fc=function(U,Y,A,c,d){var T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS;
return g.S(function(To){switch(To.T){case 1:return T=g.YX(U,"mainVideoEntity"),E=g.YX(U,"ytMainChannelEntity"),L=g.YX(U,"transfer"),r=g.YX(U,"videoDownloadContextEntity"),g.x(To,IA(Y,{mode:"readonly",kt:!0},function(t){return g.NC.all([Zv(t,T,"mainVideoEntity"),Zv(t,E,"ytMainChannelEntity"),Zv(t,L,"transfer"),Zv(t,r,"videoDownloadContextEntity"),OK(t,"ytMainChannelEntity"),OK(t,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:l=To.Y;P=g.J(l);V=P.next().value;v=P.next().value;H=P.next().value;G=P.next().value;F=P.next().value;N=P.next().value;e=V;B=v;f=H;h=G;Q=F;K=N;if(!e&&!B){To.uY(3);break}D=e?HQ(e.thumbnail):[];if(!B){c3=[];To.uY(4);break}return g.x(To,cZT(B,Q),5);case 5:c3=To.Y;case 4:return TV=c3,g.x(To,i5(D.concat(TV)),3);case 3:U9=[];LY=g.YX(U,"downloadStatusEntity");q=g.J(K);for(FE=q.next();!FE.done;FE=q.next())B3=FE.value,O9=g.Uk(B3.key).entityId,tq=WQ(B3),Lj=g.Uk(tq.action.entityKey).entityId,O9!==U&&Lj!==
U||$d(A,B3.actionProto)||U9.push(B3.key);return g.x(To,IA(Y,{mode:"readwrite",kt:!0},function(t){var zV=U9.map(function(Im){return y3(t,Im)});
zV.push(y3(t,T,{fD:!0}));zV.push(y3(t,LY,{fD:!0}));return g.NC.all(zV)}),7);
case 7:eS=(kl=h)==null?void 0:kl.offlineModeType,d&&(oI(d),d.offlineModeType&&(eS=d.offlineModeType)),vQ(f,eS),Tn(c,{entityKey:T,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.i8(To)}})},ECw=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL,Rm,vW,b8,hq,am,k,R,a,b,m,N4,A3,W3;
return g.S(function(dX){switch(dX.T){case 1:return d=g.YX(U,"mainPlaylistEntity"),T=g.YX(U,"ytMainChannelEntity"),g.x(dX,IA(Y,{mode:"readonly",kt:!0},function(ac){return g.NC.all([Zv(ac,d,"mainPlaylistEntity"),Zv(ac,T,"ytMainChannelEntity"),OK(ac,"mainPlaylistEntity"),OK(ac,"mainDownloadsListEntity"),OK(ac,"ytMainChannelEntity"),OK(ac,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:E=dX.Y;L=g.J(E);r=L.next().value;l=L.next().value;P=L.next().value;V=L.next().value;v=L.next().value;H=L.next().value;G=r;F=l;N=P;e=V;B=v;f=H;if(!G&&!F){dX.uY(3);break}h=G?dvF(G):[];if(!F){Q=[];dX.uY(4);break}return g.x(dX,cZT(F,B),5);case 5:Q=dX.Y;case 4:return K=Q,g.x(dX,i5(h.concat(K)),3);case 3:D=[];c3=new Map;if(!G){dX.uY(7);break}return g.x(dX,TqW(G,N,e),8);case 8:D=dX.Y;TV=g.J(D);for(U9=TV.next();!U9.done;U9=TV.next())LY=U9.value,c3.set(LY,{videoId:LY,playlistId:U,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.x(dX,IA(Y,{mode:"readonly",kt:!0},function(ac){return g.NC.all([OK(ac,"transfer"),OK(ac,"videoDownloadContextEntity")])}),9);
case 9:q=dX.Y;FE=g.J(q);B3=FE.next().value;O9=FE.next().value;tq=B3;Lj=O9;kl=g.J(tq);for(eS=kl.next();!eS.done;eS=kl.next())To=eS.value,t=g.Uk(To.key).entityId,(zV=c3.get(t))&&To&&(zV.cotn=To.cotn);Im=g.J(Lj);for(jL=Im.next();!jL.done;jL=Im.next())Rm=jL.value,vW=g.Uk(Rm.key).entityId,(b8=c3.get(vW))&&Rm&&(b8.offlineModeType=Rm.offlineModeType);case 7:hq=[];am=g.J(f);for(k=am.next();!k.done;k=am.next())R=k.value,a=g.Uk(R.key).entityId,b=WQ(R),a!==U&&b.rootActionId!==U||$d(A,R.actionProto)||hq.push(R.key);
m=g.YX(U,"mainPlaylistEntity");return g.x(dX,IA(Y,{mode:"readwrite",kt:!0},function(ac){var KY=hq.map(function(jz){return y3(ac,jz)});
KY.push(y3(ac,m,{fD:!0}));return g.NC.all(KY)}),10);
case 10:if(!G){dX.uY(0);break}D.reverse();if(!D){dX.uY(0);break}N4=g.J(D);A3=N4.next();case 13:if(A3.done){dX.uY(0);break}W3=A3.value;return g.x(dX,Fc(W3,Y,A,c,c3.get(W3)),14);case 14:A3=N4.next(),dX.uY(13)}})},zpq=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v;
return g.S(function(H){if(H.T==1)return d=g.YX("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),T=new Map,g.x(H,IA(U,{mode:"readwrite",kt:!0},function(G){var F=OK(G,"transfer"),N=OK(G,"offlineOrchestrationActionWrapperEntity"),e=OK(G,"videoDownloadContextEntity"),B=Zv(G,d,"mainDownloadsListEntity");return g.NC.all([F,N,e,B]).then(function(f){f=g.J(f);var h=f.next().value;var Q=f.next().value;var K=f.next().value;var D=f.next().value;f=oCz.map(function(TV){return Ajo(G,TV)});
Q=g.J(Q);for(var c3=Q.next();!c3.done;c3=Q.next())c3=c3.value,$d(Y,c3.actionProto)||f.push(y3(G,c3.key,{fD:!0}));D&&(D.downloads=[],f.push(g0(G,D,"mainDownloadsListEntity")));if(K)for(K=g.J(K),D=K.next();!D.done;D=K.next())D=D.value,Q=g.Uk(D.key).entityId,Q=g.YX(Q,"transfer"),T.set(Q,D.offlineModeType);return g.NC.all(f).then(function(){return h})})}),2);
E=H.Y;L=g.J(E);for(r=L.next();!r.done;r=L.next())l=r.value,vQ(l,T.get(l.key)),P=g.Uk(l.key).entityId,V={videoId:P,offlineDeleteReason:c,cotn:l.cotn,offlineModeType:T.get(l.key)},oI(V),v=g.YX(P,"mainVideoEntity"),Tn(A,{entityKey:v,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.x(H,AZW(),0)})},dvF=function(U,Y){var A=[];
if(U.thumbnailStyleData){U=g.J(U.thumbnailStyleData);for(var c=U.next();!c.done;c=U.next()){var d=void 0,T=void 0,E=void 0;A=A.concat(HQ((d=c.value)==null?void 0:(T=d.value)==null?void 0:(E=T.collageThumbnail)==null?void 0:E.coverThumbnail))}}Y=HQ(Y);return A.concat(Y)},TqW=function(U,Y,A){var c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV;
return g.S(function(U9){c=[];d=new Set;if(A.length)for(T=g.J(A),E=T.next();!E.done;E=T.next())if(L=E.value,r=void 0,(r=L.downloads)==null?0:r.length)for(l=g.J(L.downloads),P=l.next();!P.done;P=l.next())V=P.value,V.videoItem&&(v=g.Uk(V.videoItem).entityId,d.add(v));if(U.videos){H=g.J(U.videos);for(G=H.next();!G.done;G=H.next())F=G.value,N=JSON.parse(g.Uk(F).entityId),N.videoId&&!d.has(N.videoId)&&c.push(N.videoId);e=g.J(Y);for(B=e.next();!B.done;B=e.next())if(f=B.value,f.key!==U.key&&(h=f.videos))for(Q=
g.J(h),K=Q.next();!K.done;K=Q.next())D=K.value,c3=JSON.parse(g.Uk(D).entityId),c3.videoId&&(TV=c.indexOf(c3.videoId),TV!==-1&&c.splice(TV,1))}return U9.return(c)})},cZT=function(U,Y){var A,c,d,T,E,L,r,l;
return g.S(function(P){A=HQ(U.avatar);c=g.J(Y);for(d=c.next();!d.done;d=c.next())if(T=d.value,T.id!==U.id)for(E=g.J(HQ(T.avatar)),L=E.next();!L.done;L=E.next())r=L.value,l=A.indexOf(r),l!==-1&&A.splice(l,1);return P.return(A)})},LIm=function(U){var Y;
return g.S(function(A){Y=g.O(U.frameworkUpdates,jZ);return U.frameworkUpdates&&Y?g.x(A,vUf(Y),0):A.return()})},lGO=function(U){var Y;
if((Y=U.onResponseReceivedActions)!=null&&Y.length){var A;U=(A=g.O(g.O(U.onResponseReceivedActions[0],rZI),g.wiz))==null?void 0:A.actions;if(U!=null&&U.length)return U}},PQL=function(U){var Y,A,c;
return g.S(function(d){if(d.T==1)return U?g.x(d,Kt(U,g.sL,"mainDownloadsListEntity"),2):d.return([]);Y=d.Y;return((A=Y)==null?0:(c=A.downloads)==null?0:c.length)?d.return(Y.downloads.map(function(T){var E;return(E=T.videoItem)!=null?E:""})):d.return([])})},$vf=function(U,Y){var A;
return g.S(function(c){return c.T==1?g.x(c,VkO(U,Y),2):(A=c.Y)?g.x(c,IA(U,{mode:"readwrite",kt:!0},function(d){var T=[g0(d,A.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];A.mainDownloadsListEntity&&T.push(g0(d,A.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.NC.all(T)}),0):c.uY(0)})},VkO=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f;
return g.S(function(h){if(h.T==1)return A=g.YX("main_downloads_library_id","mainDownloadsLibraryEntity"),c=g.YX("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.x(h,IA(U,{mode:"readonly",kt:!0},function(Q){return g.NC.all([Zv(Q,A,"mainDownloadsLibraryEntity"),Zv(Q,c,"mainDownloadsListEntity")])}),2);
d=h.Y;T=g.J(d);E=T.next().value;L=T.next().value;r=E;l=L;r||(r={id:A});P=g.J(Y);for(V=P.next();!V.done;V=P.next())if(v=V.value,v===g.sL){if(r.smartDownloadsList)return h.return();r.smartDownloadsList=v}else if(H=g.Uk(v).entityType,G={},H==="mainPlaylistEntity"?G.playlistItem=v:H==="mainVideoEntity"&&(G.videoItem=v),!g.qF(G)){F=void 0;if((F=l)==null?0:F.downloads){N=!1;e=g.J(l.downloads);for(B=e.next();!B.done;B=e.next())if(f=B.value,f.playlistItem===v||f.videoItem===v){N=!0;break}N||l.downloads.push(G)}else l=
{id:c,downloads:[G]};r.downloadsList=c}return h.return({mainDownloadsLibraryEntity:r,mainDownloadsListEntity:l})})},vCT=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N;
return g.S(function(e){if(e.T==1)return A=g.YX("main_downloads_library_id","mainDownloadsLibraryEntity"),c=g.YX("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.x(e,IA(U,{mode:"readonly",kt:!0},function(B){return g.NC.all([Zv(B,A,"mainDownloadsLibraryEntity"),Zv(B,c,"mainDownloadsListEntity"),Zv(B,g.sL,"mainDownloadsListEntity")])}),2);
d=e.Y;T=g.J(d);E=T.next().value;L=T.next().value;r=T.next().value;l=E;P=L;V=r;if(!l)return e.uY(0);if(Y===g.sL&&((v=V)==null?0:v.downloads))V.downloads=[];else if((H=P)==null?0:H.downloads)for(G=g.Uk(Y).entityType,F=0;F<P.downloads.length;F++)if(N=P.downloads[F],G==="mainVideoEntity"&&N.videoItem===Y){P.downloads.splice(F,1);break}else if(G==="mainPlaylistEntity"&&N.playlistItem===Y){P.downloads.splice(F,1);break}return g.x(e,IA(U,{mode:"readwrite",kt:!0},function(B){var f=[g0(B,l,"mainDownloadsLibraryEntity")];
P&&f.push(g0(B,P,"mainDownloadsListEntity"));V&&f.push(g0(B,V,"mainDownloadsListEntity"));return g.NC.all(f)}),0)})},Nu=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v;
return g.S(function(H){if(H.T==1)return A=g.YX(Y,"transfer"),c=g.YX(Y,"videoDownloadContextEntity"),g.x(H,IA(U,{mode:"readonly",kt:!0},function(G){return g.NC.all([Zv(G,A,"transfer"),Zv(G,c,"videoDownloadContextEntity")])}),2);
d=H.Y;T=g.J(d);E=T.next().value;L=T.next().value;r=E;l=L;v={videoId:Y,cotn:(P=r)==null?void 0:P.cotn,offlineModeType:(V=l)==null?void 0:V.offlineModeType};return H.return(v)})},ts=function(U,Y,A,c,d){var T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3;
return g.S(function(TV){switch(TV.T){case 1:return T=g.YX(U,"musicTrack"),E=g.YX(U,"transfer"),g.x(TV,IA(Y,{mode:"readonly",kt:!0},function(U9){return g.NC.all([Zv(U9,T,"musicTrack"),Zv(U9,E,"transfer"),OK(U9,"musicTrack"),OK(U9,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:L=TV.Y;r=g.J(L);l=r.next().value;P=r.next().value;V=r.next().value;v=r.next().value;H=l;G=P;F=V;N=v;if(!H){TV.uY(3);break}return g.x(TV,HBO(H,F),4);case 4:return e=TV.Y,g.x(TV,i5(e),3);case 3:B=[];f=g.J(N);for(h=f.next();!h.done;h=f.next())Q=h.value,K=g.Uk(Q.key).entityId,D=WQ(Q),c3=g.Uk(D.action.entityKey).entityId,K!==U&&c3!==U||$d(A,Q.actionProto)||B.push(Q.key);return g.x(TV,IA(Y,{mode:"readwrite",kt:!0},function(U9){var LY=B.map(function(q){return y3(U9,q)});
LY.push(y3(U9,T,{fD:!0}));return g.NC.all(LY)}),6);
case 6:vQ(G),d&&oI(d),Tn(c,{entityKey:T,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.i8(TV)}})},eZ=function(U,Y,A,c,d){var T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL;
return g.S(function(Rm){switch(Rm.T){case 1:return T=g.YX(U,Y),E=g.YX("music_downloads_library_id","musicDownloadsLibraryEntity"),g.x(Rm,IA(A,{mode:"readonly",kt:!0},function(vW){return g.NC.all([Zv(vW,T,Y),Zv(vW,E,"musicDownloadsLibraryEntity"),OK(vW,Y),OK(vW,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:L=Rm.Y;r=g.J(L);l=r.next().value;P=r.next().value;V=r.next().value;v=r.next().value;H=l;G=P;F=V;N=v;if(!H){Rm.uY(3);break}return g.x(Rm,HBO(H,F),4);case 4:return e=Rm.Y,g.x(Rm,i5(e),3);case 3:B=[];f=new Map;if(!H){Rm.uY(6);break}return g.x(Rm,G6z(H,F,G),7);case 7:B=Rm.Y;h=g.J(B);for(Q=h.next();!Q.done;Q=h.next())K=Q.value,D=g.Uk(K).entityId,f.set(D,{videoId:D,playlistId:U,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.x(Rm,q$(A,"transfer"),8);case 8:for(c3=Rm.Y,TV=
g.J(c3),U9=TV.next();!U9.done;U9=TV.next())LY=U9.value,q=g.Uk(LY.key).entityId,(FE=f.get(q))&&LY&&(FE.cotn=LY.cotn);case 6:B3=[];O9=g.J(N);for(tq=O9.next();!tq.done;tq=O9.next())Lj=tq.value,kl=g.Uk(Lj.key).entityId,eS=WQ(Lj),kl!==U&&eS.rootActionId!==U||$d(c,Lj.actionProto)||B3.push(Lj.key);To=g.YX(U,Y);return g.x(Rm,IA(A,{mode:"readwrite",kt:!0},function(vW){var b8=B3.map(function(hq){return y3(vW,hq)});
b8.push(y3(vW,To,{fD:!0}));return g.NC.all(b8)}),9);
case 9:if(!H){Rm.uY(0);break}B.reverse();if(!B.length){Rm.uY(0);break}t=g.J(B);zV=t.next();case 12:if(zV.done){Rm.uY(0);break}Im=zV.value;jL=g.Uk(Im).entityId;if(!jL){Rm.uY(13);break}return g.x(Rm,ts(jL,A,c,d,f.get(jL)),13);case 13:zV=t.next(),Rm.uY(12)}})},BQ=function(U,Y,A){var c,d,T,E,L,r,l;
return g.S(function(P){if(P.T==1)return g.x(P,IA(U,{mode:"readwrite",kt:!0},function(V){var v=OK(V,"transfer"),H=OK(V,"offlineOrchestrationActionWrapperEntity");return g.NC.all([v,H]).then(function(G){G=g.J(G);var F=G.next().value;var N=G.next().value;G=WIo.map(function(h){return Ajo(V,h)});
N=g.J(N);for(var e=N.next();!e.done;e=N.next()){e=e.value;var B=g.Uk(e.actionProto.entityKey).entityType==="musicTrack",f=e.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";$d(Y,e.actionProto)||B&&(!B||f)||G.push(y3(V,e.key,{fD:!0}))}return g.NC.all(G).then(function(){return F})})}),2);
c=P.Y;d=g.J(c);for(T=d.next();!T.done;T=d.next())E=T.value,vQ(E),L=g.Uk(E.key).entityId,r={videoId:L,offlineDeleteReason:void 0,cotn:E.cotn},oI(r),l=g.YX(L,"musicTrack"),Tn(A,{entityKey:l,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.x(P,AZW(),0)})},wPf=function(U){for(var Y,A=g.J(U.additionalMetadatas),c=A.next();!c.done;c=A.next())c=c.value,c.offlineMusicVideoData&&(Y=c.offlineMusicVideoData);
var d,T,E,L,r;return{id:g.YX(U.videoId,"musicTrack"),videoId:U.videoId,title:U.title,thumbnailDetails:U.thumbnail,lengthMs:String(Number(U.lengthSeconds)*1E3),albumTitle:(d=Y)==null?void 0:d.releaseTitle,musicVideoType:(T=Y)==null?void 0:T.musicVideoType,contentRating:{explicitType:(E=Y)==null?void 0:E.explicitType},artistNames:((L=Y)==null?void 0:L.byline)||((r=Y)==null?void 0:r.channelName),downloadMetadata:g.YX(U.videoId,"musicTrackDownloadMetadataEntity")}},G6z=function(U,Y,A){var c,d,T,E,L,r,
l,P,V,v,H,G,F,N,e,B,f,h;
return g.S(function(Q){c=[];d=new Set;if((T=A)==null?0:(E=T.downloadedTracks)==null?0:E.length)for(L=g.J(A.downloadedTracks),r=L.next();!r.done;r=L.next())l=r.value,d.add(l);if(U.tracks){P=g.J(U.tracks);for(V=P.next();!V.done;V=P.next())v=V.value,d.has(v)||c.push(v);H=g.J(Y);for(G=H.next();!G.done;G=H.next())if(F=G.value,F.id!==U.id&&(N=F.tracks))for(e=g.J(N),B=e.next();!B.done;B=e.next())f=B.value,h=c.indexOf(f),h!==-1&&c.splice(h,1)}return Q.return(c)})},HBO=function(U,Y){var A,c,d,T,E,L,r,l;
return g.S(function(P){A=HQ(U.thumbnailDetails);c=g.J(Y);for(d=c.next();!d.done;d=c.next())if(T=d.value,T.id!==U.id)for(E=g.J(HQ(T.thumbnailDetails)),L=E.next();!L.done;L=E.next())r=L.value,l=A.indexOf(r),l!==-1&&A.splice(l,1);return P.return(A)})},iBT=function(U,Y){var A,c,d,T,E,L,r,l,P;
return g.S(function(V){if(V.T==1)return A=g.YX("music_downloads_library_id","musicDownloadsLibraryEntity"),g.x(V,Kt(U,A,"musicDownloadsLibraryEntity"),2);(c=V.Y)||(c={id:A});d=g.Uk(Y).entityType;d==="musicTrack"?(T=c.downloadedTracks)!=null&&T.includes(Y)||(c.downloadedTracks=((E=c.downloadedTracks)!=null?E:[]).concat(Y)):d==="musicPlaylist"?(L=c.downloadedPlaylists)!=null&&L.includes(Y)||(c.downloadedPlaylists=((r=c.downloadedPlaylists)!=null?r:[]).concat(Y)):d!=="musicAlbumRelease"||(l=c.downloadedAlbumReleases)!=
null&&l.includes(Y)||(c.downloadedAlbumReleases=((P=c.downloadedAlbumReleases)!=null?P:[]).concat(Y));return g.x(V,u_(U,c,"musicDownloadsLibraryEntity"),0)})},JZL=function(U,Y){var A,c,d,T,E,L,r;
return g.S(function(l){if(l.T==1)return A=g.YX("music_downloads_library_id","musicDownloadsLibraryEntity"),g.x(l,Kt(U,A,"musicDownloadsLibraryEntity"),2);c=l.Y;if(!c)return l.uY(0);d=g.Uk(Y).entityType;d==="musicTrack"?T=c.downloadedTracks:d==="musicPlaylist"&&(T=c.downloadedPlaylists);if((E=T)==null?0:E.length)for(L=0;L<T.length;L++)if(r=T[L],r===Y){T.splice(L,1);break}return g.x(l,u_(U,c,"musicDownloadsLibraryEntity"),0)})},FIf=function(U){var Y=U.videos;
U=[];var A=[];if(Y){Y=g.J(Y);for(var c=Y.next();!c.done;c=Y.next()){var d=c.value.offlineVideoData.videoId;c=g.YX(d,"musicTrack");d=g.YX(d,"musicTrackDownloadMetadataEntity");U.push(c);A.push(d)}}return{dZ:U,OU:A}},Xc=function(U,Y,A){Y={track:wPf(Y)};
A&&(Y.playlistId=A);if(U=g.O(U.actionMetadata,jMI))Y.maximumDownloadQuality=U.maximumDownloadQuality;return{musicTrackEntityActionMetadata:Y}},tkf=function(U){var Y,A,c,d,T,E,L,r;
return g.S(function(l){switch(l.T){case 1:return Y=g.zL(),A=j_z(U),c=g.AL(Nqm),g.J3(l,2),T={Ac:!0},g.x(l,g.KK(Y,A,c,void 0,T),4);case 4:d=l.Y;g.t3(l,3);break;case 2:E=g.XE(l);if(E instanceof g.TL)throw L="GetOffline network manager error: "+E.message,cQ(L,E),Error(L);cQ("GetOffline fetch request error",E);throw Error("GetOffline fetch request error");case 3:r=kd(d);if(!d)throw cQ("Network request failed"),Error("Network request failed");if(r!==void 0)RI(r);else if(!d.videos||!d.videos.length)throw cQ("No data"),
Error("No data");return l.return(d.videos.map(function(P){return P.offlineVideoData}))}})},epW=function(U){var Y,A,c,d,T,E,L,r;
return g.S(function(l){switch(l.T){case 1:return Y=g.zL(),A=NpY(U),c=g.AL(Nqm),g.J3(l,2),T={Ac:!0},g.x(l,g.KK(Y,A,c,void 0,T),4);case 4:d=l.Y;g.t3(l,3);break;case 2:E=g.XE(l);if(E instanceof g.TL)throw L="GetOffline network manager error for playlist: "+E.message,cQ(L,E),Error(L);cQ("GetOffline fetch request error for playlist",E);throw Error("GetOffline fetch request error for playlist");case 3:r=kd(d);if(!d)throw cQ("Network request failed for playlist"),Error("Network request failed for playlist");
if(r!==void 0)RI(r,"playlist");else if(!d.playlists||!d.playlists.length)throw cQ("No data for playlist"),Error("No data for playlist");return l.return(d.playlists.map(function(P){return P.offlinePlaylistData}))}})},XPq=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj;
return g.S(function(kl){switch(kl.T){case 1:return g.x(kl,Ct(),2);case 2:d=kl.Y;if(!d)return kl.return([]);T=[];if((E=c)==null?0:E.length){T=c;kl.uY(3);break}return g.x(kl,q$(d,"mainPlaylistEntity"),4);case 4:T=kl.Y;case 3:if(!T.length)return kl.return([]);L=[];r=Date.now()/1E3;l=g.J(T);P=l.next();case 5:if(P.done)return L.length?g.x(kl,BqL(L),10):kl.return([]);V=P.value;if(!V.downloadState){v=void 0;kl.uY(8);break}return g.x(kl,Kt(d,V.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:v=
kl.Y;case 8:H=v;G=void 0;N=(F=(G=V)==null?void 0:G.entityMetadata)&&F.nextAutoRefreshIntervalSeconds?Number(F.nextAutoRefreshIntervalSeconds):NaN;e=Number.isNaN(N)?U:N;f=B=void 0;h=((B=H)==null?0:B.lastSyncedTimestampMillis)?Number((f=H)==null?void 0:f.lastSyncedTimestampMillis)/1E3:0;K=Q=void 0;D=((Q=H)==null?0:Q.addedTimestampMillis)?Number((K=H)==null?void 0:K.addedTimestampMillis)/1E3:0;if(A||!F||h+e<=r){c3=[];TV=void 0;if((TV=V.videos)==null?0:TV.length)for(U9=g.J(V.videos),LY=U9.next();!LY.done;LY=
U9.next())q=LY.value,FE=JSON.parse(g.Uk(q).entityId),FE.videoId&&c3.push(FE.videoId);B3="0";F&&(O9=void 0,B3=String(Number((O9=F.offlineLastModifiedTimestampSeconds)!=null?O9:0).toFixed()));tq={playlistId:V.playlistId,videoIds:c3,offlineLastModifiedTimestamp:B3,autoSync:Y,offlineDateAddedTimestamp:String(D.toFixed())};L.push(tq)}P=l.next();kl.uY(5);break;case 10:return Lj=kl.Y,kl.return(Lj)}})},k6O=function(){var U,Y,A,c,d;
return g.S(function(T){if(T.T==1)return g.x(T,Ct(),2);if(T.T!=3)return(U=T.Y)?g.x(T,q$(U,"refresh"),3):T.return(!1);Y=T.Y;if((A=Y[0])==null||!A.refreshTime)return T.return(!1);c=Number(Y[0].refreshTime);d=Date.now()/1E3;return T.return(isFinite(c)&&d>=c)})},aGf=function(U,Y){var A,c,d;
return g.S(function(T){switch(T.T){case 1:return g.J3(T,2),g.x(T,Rpz(U,Y),4);case 4:return c=T.Y,g.x(T,LIm(c),5);case 5:A=lGO(c);g.t3(T,3);break;case 2:d=g.XE(T),cQ("getAndProcessSmartDownloadsResponse request or processing error",d);case 3:return T.return(A)}})},xvz=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj;
return g.S(function(kl){switch(kl.T){case 1:return g.x(kl,Ct(),2);case 2:d=kl.Y;if(!d)return kl.return([]);T=[];if((E=c)==null?0:E.length){T=c;kl.uY(3);break}return g.x(kl,q$(d,"musicPlaylist"),4);case 4:T=kl.Y;case 3:if(!T.length)return kl.return([]);L=[];r=Date.now()/1E3;l=g.J(T);P=l.next();case 5:if(P.done)return L.length?g.x(kl,BqL(L),10):kl.return([]);V=P.value;v=void 0;G=(H=(v=V)==null?void 0:v.entityMetadata)&&H.nextAutoRefreshIntervalSeconds?Number(H.nextAutoRefreshIntervalSeconds):NaN;F=
Number.isNaN(G)?U:G;e=N=0;B="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!V.downloadMetadata){kl.uY(8);break}return g.x(kl,Kt(d,V.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:f=kl.Y,Q=h=void 0,N=Number((Q=(h=f)==null?void 0:h.addedTimestampMillis)!=null?Q:"0")/1E3,D=K=void 0,e=Number((D=(K=f)==null?void 0:K.lastModifiedTimestampMillis)!=null?D:"0")/1E3,TV=c3=void 0,B=(TV=(c3=f)==null?void 0:c3.syncState)!=null?TV:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:U9=void 0;if(A||B!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!H||Number((U9=H.lastSyncedTimestampSeconds)!=null?U9:0)+F<=r){LY=[];q=void 0;if((q=V.tracks)==null?0:q.length)for(FE=g.J(V.tracks),B3=FE.next();!B3.done;B3=FE.next())O9=B3.value,LY.push(g.Uk(O9).entityId);tq={playlistId:V.playlistId,videoIds:LY,offlineLastModifiedTimestamp:String(e.toFixed()),autoSync:Y,offlineDateAddedTimestamp:String(N.toFixed())};L.push(tq)}P=l.next();kl.uY(5);break;case 10:return Lj=kl.Y,kl.return(Lj)}})},Rpz=function(U,Y){var A,c,d,T,E,L,r,l,P,V;
return g.S(function(v){switch(v.T){case 1:return A=g.zL(),g.x(v,Ct(),2);case 2:c=v.Y;if(!c){v.uY(3);break}return g.x(v,a_Y(c),4);case 4:d=v.Y;case 3:var H=d;T={context:g.CV(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:U},offlineClientState:H,clientStateRequestData:{preferredFormatType:Y}}}};E=g.AL(sMz);g.J3(v,5);r={Ac:!0};return g.x(v,g.KK(A,T,E,void 0,r),7);case 7:L=v.Y;g.t3(v,6);break;case 5:l=g.XE(v);if(l instanceof g.TL)throw P=
"DPS network manager error for smart downloads: "+l.message,cQ(P,l),Error(P);cQ("DPS fetch request error for smart downloads",l);throw Error("DPS fetch request error for smart downloads");case 6:V=kd(L);if(L)V!==void 0&&RI(V,"smart downloads");else throw cQ("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return v.return(L)}})},hpT=function(U,Y){var A,c,d,T,E,L,r,l;
return g.S(function(P){switch(P.T){case 1:return A=g.zL(),c={context:g.CV(),videoPlaybackPositionEntities:U,lastSyncTimestampUsec:Y},d=g.AL(fGT),g.J3(P,2),E={Ac:!0},g.x(P,g.KK(A,c,d,void 0,E),4);case 4:T=P.Y;g.t3(P,3);break;case 2:L=g.XE(P);if(L instanceof g.TL)throw r="VPPS network manager error: "+L.message,cQ(r,L),Error(r);cQ("VPPS fetch request error",L);throw Error("VPPS fetch request error");case 3:l=kd(T);if(T)l!==void 0&&RI(l,"position sync");else throw cQ("Network request failed for position sync"),
Error("Network request failed for position sync");return P.return(T)}})},Mko=function(U,Y,A){var c,d,T,E,L,r,l,P;
return g.S(function(V){switch(V.T){case 1:c=g.zL();var v=A.refreshData,H=A.isEnqueuedForExpiredStreamUrlRefetch,G=A.xA,F=A.offlineSourceData,N=A.mediaCapabilities,e={entityKey:U};v&&(e.refreshData=v);H&&(e.isExpiredStreamUrlRefetch=H);G&&(e.downloadParameters=G);F&&(e.offlineSourceData=F);v={context:g.Al(Y),signatureTimestamp:20201,videos:[e]};N&&(v.mediaCapabilities=N);d=v;T=g.AL(SAf);g.J3(V,2);L={Ac:!0};return g.x(V,g.KK(c,d,T,void 0,L),4);case 4:E=V.Y;g.t3(V,3);break;case 2:r=g.XE(V);if(r instanceof
g.TL)throw l="GetPDE network manager error: "+r.message,cQ(l,r),Error(l);cQ("GetPDE fetch request error",r);throw Error("GetPDE fetch request error");case 3:P=kd(E);if(E)P!==void 0&&RI(P,"PDE");else throw cQ("Network request failed for PDE"),Error("Network request failed for PDE");return V.return(E)}})},kd=function(U){var Y;
return(Y=U.errorMetadata)==null?void 0:Y.status},RI=function(U,Y){Y=Y?" for "+Y:"";
if(U===0)throw U="Empty response body"+Y,cQ(U),Error(U);U="Response with error"+Y;cQ(U);throw Error(U);},BqL=function(U){var Y,A,c,d,T,E,L,r;
return g.S(function(l){switch(l.T){case 1:return Y=g.zL(),A=tJT(U),c=g.AL(bBw),g.J3(l,2),T={Ac:!0},g.x(l,g.KK(Y,A,c,void 0,T),4);case 4:d=l.Y;g.t3(l,3);break;case 2:E=g.XE(l);if(E instanceof g.TL)throw L="offlinePlaylistSyncCheck network manager error: "+E.message,cQ(L,E),Error(L);cQ("offlinePlaylistSyncCheck fetch request error",E);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:r=kd(d);if(!d)throw cQ("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(r!==void 0)RI(r,"playlist sync");else if(!d.offlinePlaylistSyncCheckDatas||!d.offlinePlaylistSyncCheckDatas.length)throw cQ("No data for playlist sync"),Error("No data for playlist sync");return l.return(d.offlinePlaylistSyncCheckDatas.map(function(P){return P.offlinePlaylistSyncCheckData}))}})},aI=function(U){this.Y=U},pPY=function(U,Y){var A,c,d,T,E,L;
return g.S(function(r){switch(r.T){case 1:A=new Map,c=g.J(Y),d=c.next();case 2:if(d.done){r.uY(4);break}T=d.value;E=A;L=E.set;return g.x(r,U.T(T),5);case 5:L.call(E,T,r.Y);d=c.next();r.uY(2);break;case 4:return r.return(A)}})},xd=function(U,Y,A,c,d,T){Y=g.YX(Y,A);
c=Object.assign({},T,{priority:c,retryScheduleIntervalsInSeconds:d});return{actionType:U,entityKey:Y,actionMetadata:c}},sm=function(U,Y,A,c,d,T){this.status=U;
this.Y=Y;this.j=A;this.T=c;this.W=d;this.downloadState=T},QMz=function(U,Y,A){this.Y=U;
this.MI=Y;this.W=A},mvY=function(U,Y){var A,c,d,T,E,L,r,l,P;
return g.S(function(V){switch(V.T){case 1:return A=Y.entityKey,d=(c=g.O(Y.actionMetadata,fP))==null?void 0:c.isEnqueuedForExpiredStreamUrlRefetch,g.J3(V,2),T=void 0,g.x(V,ZBY(U,Y),4);case 4:T=V.Y;g.J3(V,5);var v=(v=g.O(Y.actionMetadata,fP))?{maximumDownloadQuality:v.maximumDownloadQuality}:void 0;return g.x(V,Mko(A,U.MI,{isEnqueuedForExpiredStreamUrlRefetch:d,xA:v,offlineSourceData:T}),7);case 7:E=V.Y;g.t3(V,6,2);break;case 5:return g.XE(V,2),L=LP(Y)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",cQ("PDE handleAdd error"),V.return(hs(Y,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",L,"DOWNLOAD_STATE_FAILED"));case 6:return g.x(V,OBo(U,E,Y),8);case 8:return V.return(hs(Y,!0,E.orchestrationActions));case 2:return r=g.XE(V),l="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",P="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",r instanceof g.G1&&r.type==="QUOTA_EXCEEDED"&&(l="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
P="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),cQ("PDE handleAdd error"),V.return(hs(Y,!1,void 0,l,P,"DOWNLOAD_STATE_FAILED"))}})},nCO=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV;
return g.S(function(U9){switch(U9.T){case 1:return A=Y.entityKey,c=g.Uk(A).entityId,g.x(U9,IA(U.Y,{mode:"readonly",kt:!0},function(LY){var q=Zv(LY,A,"playbackData"),FE=Zv(LY,g.YX(c,"offlineVideoPolicy"),"offlineVideoPolicy");LY=Zv(LY,g.YX(c,"transfer"),"transfer");return g.NC.all([q,FE,LY])}),2);
case 2:d=U9.Y;T=g.J(d);E=T.next().value;L=T.next().value;r=T.next().value;l=E;P=L;V=r;if(!l||!P)return U9.return(hs(Y,!0));v=[];F=((G=l)==null?0:G.playerResponseJson)?JSON.parse(l.playerResponseJson):null;if(!(V&&F&&U.MI.S("html5_refresh_deprecated_downloads"))){U9.uY(3);break}H=gCq(U,F,V);return g.x(U9,yZI(U,V),4);case 4:v=U9.Y;case 3:N={lastPlayerResponseTimestampSeconds:l.playerResponseTimestamp,offlineToken:P.offlineToken,formatIds:v};e={};if((B=V)==null?0:B.maximumDownloadQuality)e.maximumDownloadQuality=
V.maximumDownloadQuality;g.J3(U9,5);f=void 0;return g.x(U9,ZBY(U,Y),7);case 7:return f=U9.Y,g.J3(U9,8),g.x(U9,Mko(A,U.MI,{refreshData:N,xA:e,offlineSourceData:f,mediaCapabilities:H}),10);case 10:h=U9.Y;g.t3(U9,9,5);break;case 8:return g.XE(U9,5),Q=LP(Y)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",cQ("PDE handleRefresh error"),U9.return(hs(Y,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",Q,
"DOWNLOAD_STATE_FAILED"));case 9:return g.x(U9,OBo(U,h,Y),11);case 11:return U9.return(hs(Y,!0,h.orchestrationActions));case 5:return K=g.XE(U9),D="PDE handleRefresh error",K instanceof Error&&(D="PDE handleRefresh error: "+K.message),c3="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",TV="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",K instanceof g.G1&&K.type==="QUOTA_EXCEEDED"&&(c3="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",TV="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
cQ(D),U9.return(hs(Y,!1,void 0,c3,TV,"DOWNLOAD_STATE_FAILED"))}})},ZBY=function(U,Y){var A,c,d,T;
return g.S(function(E){if(E.T==1)return A=g.Uk(Y.entityKey).entityId,c=g.YX(A,"videoDownloadContextEntity"),g.x(E,Kt(U.Y,c,"videoDownloadContextEntity"),2);d=E.Y;return(T=d)!=null&&T.offlineModeType?E.return({offlineModeType:d.offlineModeType}):E.return(void 0)})},OBo=function(U,Y,A){var c,d,T,E,L;
return g.S(function(r){if(r.T==1){if(!Y.frameworkUpdates||!g.O(Y.frameworkUpdates,jZ))return r.return();if(!(g.O(Y.frameworkUpdates,jZ).mutations&&g.O(Y.frameworkUpdates,jZ).mutations.length>0&&g.O(Y.frameworkUpdates,jZ).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return r.uY(2);c=g.Uk(g.O(Y.frameworkUpdates,jZ).mutations[0].entityKey).entityId;return g.x(r,Nu(U.Y,c),3)}if(r.T!=2){d=r.Y;T=g.O(A.actionMetadata,fP);if(L=(E=T)==null?void 0:E.playlistId)d.playlistId=L;d.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.Cs(U.MI)?g.x(r,Fc(c,U.Y,A,U.W,d),2):g.pV(U.MI)?g.x(r,ts(c,U.Y,A,U.W),2):r.uY(2)}return g.x(r,vUf(g.O(Y.frameworkUpdates,jZ)),0)})},hs=function(U,Y,A,c,d,T){return new sm(Y?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",LP(U),A,c,d,T)},gCq=function(U,Y,A){Y=Uvz(U.MI,A.cotn,Y);
A=g.rS(Y);return g.UZc(Y,A,U.MI)},yZI=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v;
return g.S(function(H){if(H.T==1)return A=[],g.x(H,IA(U.Y,{mode:"readonly",kt:!0},function(G){var F=[],N=Y.offlineVideoStreams;if(N){N=g.J(N);for(var e=N.next();!e.done;e=N.next())F.push(Zv(G,e.value,"offlineVideoStreams"))}return g.NC.all(F)}),2);
if(c=H.Y)for(d=g.J(c),T=d.next();!T.done;T=d.next())if(E=T.value,L=void 0,(L=E)==null?0:L.streamsProgress)for(r=E.streamsProgress,l=0;l<r.length;l++)P=r[l],V=JSON.parse(P.formatStreamBytes),v={itag:V.itag,lmt:V.lastModified,xtags:V.xtags},A.push(v);return H.return(A)})},Dvq=function(U,Y){this.Y=U;
this.MI=Y},IGO=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H;
return g.S(function(G){switch(G.T){case 1:return A=LP(Y),g.x(G,q$(U.Y,"videoPlaybackPositionEntity"),2);case 2:c=G.Y;if(c.length===0)return G.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));g.J3(G,3);return g.x(G,b_.getInstance(),5);case 5:d=G.Y;if(!d)throw Error("prefStorage is undefined");return g.x(G,d.get("psi"),6);case 6:return T=G.Y,r=(L=(E=T)==null?void 0:E.GJ)!=null?L:"0",g.x(G,hpT(c,r),7);case 7:return l=G.Y,P={isPaused:l.watchHistoryPaused,GJ:l.syncTimestampUsec},g.x(G,d.set("psi",
P),8);case 8:if(P.isPaused){G.uY(9);break}V=g.O(l.frameworkUpdates,jZ);if(!l.frameworkUpdates||!V){G.uY(9);break}return g.x(G,vUf(V),9);case 9:g.t3(G,4);break;case 3:return v=g.XE(G),H="PPE handleRefresh error: "+(v instanceof Error?v.message:"unknown error"),cQ(H),G.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return G.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},KIf=function(U,Y){var A,c,d,T,E,L,r,l;
return g.S(function(P){switch(P.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey).entityId,g.J3(P,2),g.x(P,b_.getInstance(),4);case 4:d=P.Y;if(!d)throw Error("prefStorage is undefined");return g.x(P,d.get("psi"),5);case 5:T=P.Y;E=g.O(Y.actionMetadata,u0j);if(((L=T)==null?void 0:L.isPaused)!==!1||(r=E)==null||!r.lastPlaybackPositionSeconds){P.uY(6);break}l={key:g.YX(c,"videoPlaybackPositionEntity"),videoId:c,lastPlaybackPositionSeconds:E.lastPlaybackPositionSeconds};return g.x(P,u_(U.Y,l,"videoPlaybackPositionEntity"),
6);case 6:g.t3(P,3);break;case 2:return g.XE(P),P.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return P.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A))}})},qAj=function(U,Y){var A,c,d;
return g.S(function(T){switch(T.T){case 1:A=LP(Y);g.J3(T,2);c=g.Uk(Y.entityKey).entityId;if(c==="!*$_ALL_ENTITIES_!*$")return g.x(T,rjY(U.Y),5);d=g.YX(c,"videoPlaybackPositionEntity");return g.x(T,L3w(U.Y,d),5);case 5:g.t3(T,3);break;case 2:return g.XE(T),T.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return T.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},CQm=function(U,Y){this.api=U;
this.Y=Y;this.logger=new g.o6("woffle");this.T=!1;this.o5={X0:this.X0};this.logger.debug("Initialized OfflineMediaManager")},UQF=function(U){return g.S(function(Y){return Y.return(F3o(U))})},Y4m=function(U){var Y;
return g.S(function(A){if(A.T==1)return g.x(A,g.V7X(U),2);Y=A.Y;return A.return(Y.filter(function(c){return!!c.url}).map(function(c){return c.url}))})},SZ=function(U,Y){var A=g.xQ(Y);
if(A===1||A===0)return Promise.resolve();(A=ATW(U,Y))&&A.stopVideo();U.W=0;return UQF(Y)},Mu=function(U,Y,A,c){A=A===void 0?!1:A;
c=c===void 0?!0:c;var d=typeof Y==="string"?Y:Y.videoDetails.videoId;g.xQ(d)===2&&((Y=ATW(U,d))?Y.stopVideo():U.logger.info(function(){return"Corresponding player for "+d+" not found. Pausing anyway"}),g.sJ(d,2),U.W=2,A?cTz(U.Y):c&&dQW(U.Y))},ATW=function(U,Y){var A;
return((A=U.player)==null?void 0:A.getVideoData().videoId)===Y?U.player:null},TKO=function(U,Y,A){Y.getPlayerResponse();
g.sJ(Y.videoId,2);U.W=2;U.T=!1;var c;(c=U.player)==null||c.dispose();U.player=U.api.qD(Y);Y={};U.player.oF((Y.localmediachange=U.RQ,Y.signatureexpired=U.Ka,Y.statechange=U.wQW,Y),U);var d=U.X0(A);U.player.x0(g.$N(d,d,!0,"m"),!1);U.logger.debug(function(){return"Starting headless playback with quality: "+d});
U.player.AA(!1)},Eco=function(U,Y){this.Y=U;
this.MI=Y},zfq=function(U,Y){var A,c;
return g.S(function(d){switch(d.T){case 1:return A=LP(Y),g.x(d,Kt(U.Y,Y.entityKey,"transfer"),2);case 2:if(c=d.Y)return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));g.J3(d,3);return g.x(d,ocz(U,Y),5);case 5:g.t3(d,4);break;case 3:return g.XE(d),d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},LDW=function(U,Y){var A,c;
return g.S(function(d){switch(d.T){case 1:return A=LP(Y),g.x(d,Kt(U.Y,Y.entityKey,"transfer"),2);case 2:c=d.Y;if(!c||c.transferState!=="TRANSFER_STATE_COMPLETE")return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));g.J3(d,3);return g.x(d,ocz(U,Y,!0),5);case 5:g.t3(d,4);break;case 3:return g.XE(d),d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A))}})},rTY=function(U,Y){var A,c,d,T,E,L,r,l,P,V;
return g.S(function(v){switch(v.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey).entityId,g.x(v,IA(U.Y,{mode:"readonly",kt:!0},function(H){var G=Zv(H,Y.entityKey,"transfer");H=Zv(H,g.YX(c,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.NC.all([G,H])}),2);
case 2:d=v.Y;T=g.J(d);E=T.next().value;L=T.next().value;r=E;l=L;if(!r||r.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return v.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));g.J3(v,3);r.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.x(v,u_(U.Y,r,"transfer"),5);case 5:P=g.Uk(r.key).entityId;D7F({videoId:P,sR:r,offlineModeType:(V=l)==null?void 0:V.offlineModeType});g.t3(v,4);break;case 3:return g.XE(v),v.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",
A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return v.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A))}})},ocz=function(U,Y,A){A=A===void 0?!1:A;
var c,d,T,E,L,r,l,P,V,v,H,G,F,N,e;return g.S(function(B){switch(B.T){case 1:return c=g.O(Y.actionMetadata,lUL),d=g.Uk(Y.entityKey).entityId,T=g.YX(d,"downloadStatusEntity"),g.x(B,IA(U.Y,{mode:"readonly",kt:!0},function(f){var h=Zv(f,T,"downloadStatusEntity");f=Zv(f,g.YX(d,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.NC.all([h,f])}),2);
case 2:return E=B.Y,L=g.J(E),r=L.next().value,l=L.next().value,P=r,V=l,v="TRANSFER_STATE_TRANSFER_IN_QUEUE",((H=P)==null?void 0:H.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(v="TRANSFER_STATE_PAUSED_BY_USER"),N={key:Y.entityKey,transferState:v,cotn:g.tH(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(G=c)==null?void 0:G.maximumDownloadQuality,preferredAudioTrack:(F=c)==null?void 0:F.preferredAudioTrack,transferRetryCount:0,isRefresh:A,hasLoggedFirstStarted:!1},g.x(B,IA(U.Y,
{mode:"readwrite",kt:!0},function(f){var h=[];A&&h.push(y3(f,g.YX(d,"offlineVideoStreams")));h.push(g0(f,N,"transfer"));return g.NC.all(h)}),3);
case 3:if(!A){B.uY(4);break}return g.x(B,UQF(d),4);case 4:yjY({videoId:d,sR:N,offlineModeType:(e=V)==null?void 0:e.offlineModeType}),g.i8(B)}})},VnF=function(U,Y,A,c){if(!U.action.entityKey)throw Error("entityKey is missing.");
var d=g.Uk(U.action.entityKey);d={entityType:d.Qb,entityId:d.entityId,offlineOrchestrationActionType:U.action.actionType,orchestrationAction:{orchestrationActionId:U.actionId}};Y&&(d.offlineOrchestrationActionResult=Y.status,d.isRetryable=A?!1:Y.Y,Y.W&&(d.offlineOrchestrationFailureReason=Pgw(Y.W,d.isRetryable)));var T,E;if((T=U.action.actionMetadata)==null?0:(E=T.offlineLoggingData)==null?0:E.offlineModeType)d.offlineModeType=U.action.actionMetadata.offlineLoggingData.offlineModeType;c&&(d.additionalOrchestrationActions=
c.map(function(L){return{orchestrationActionId:L.actionId}}));
return d},Pgw=function(U,Y){return U!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||Y?U==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&Y?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":U:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},$Qw=function(U,Y){var A={offlineOrchestrationContext:VnF(U)};
Y=kzq(Y,A);RNo(XLT(),Y,U.rootActionId)},vcT=function(U,Y,A,c){c=c===void 0?[]:c;
Y={offlineOrchestrationContext:VnF(U,Y,A,c)};Y=kzq(3,Y);RNo(XLT(),Y,U.rootActionId)},HZI=function(){this.actions=[]},Gxj=function(U,Y){Y=g.J(Y);
for(var A=Y.next();!A.done;A=Y.next())A=A.value,$Qw(A,1),U.actions.push(A);U.actions.sort(U.Y)},WDm=function(U,Y){if(Y)for(var A=0;A<U.actions.length;A++)if(Y==="!*$_ALL_ENTITIES_!*$"&&U.actions[A].actionId!==Y||Y!=="!*$_ALL_ENTITIES_!*$"&&U.actions[A].rootActionId===Y&&U.actions[A].actionId!==Y)U.actions.splice(A,1),A--},wFW=function(U,Y){U=g.J(U.actions);
for(var A=U.next();!A.done;A=U.next())if(A.value.actionId===Y)return!0;return!1},b5=function(U,Y,A,c,d){g.p.call(this);
var T=this;this.T=U;this.ov=Y;this.Pw=A;this.G=c;this.MI=d;this.Y=new HZI;this.J=new g.uz;this.W=new g.IM(function(){T.retry()});
this.Z=NaN;this.K=!1;this.o5={YrW:function(){return T.Y},
Fw:function(){return T.J},
Acw:function(){return T.W},
retry:function(){return T.retry()}};
g.Z(this,this.W);this.X=this.T.observe(this.Hw.bind(this))},FDo=function(U,Y,A,c,d){var T;
return g.S(function(E){if(E.T==1)return T=new b5(U,Y,A,c,d),g.x(E,iZw(T),2);JTw(T);return E.return(T)})},JTw=function(U){var Y=U.Y.actions[0];
return U.j?((Y==null?void 0:Y.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&U.j[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(U.K=!0),Promise.resolve()):juT(U)},juT=function(U){var Y,A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e;
return g.S(function(B){switch(B.T){case 1:if(U.j)throw Error("Already processing an action");if(U.Ky())return B.return();Y=U.Y.actions.shift();m7m(U.Pw,!Y);if(Y===void 0)return B.return();Y.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&Y.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&WDm(U.Y,Y.actionId);A="";Y.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&Y.rootActionId===Y.actionId&&(A=Y.actionId);c=[Y];U.j=c;if(d=U.ov[Y.entityType]){B.uY(2);break}U.j=
void 0;return g.x(B,juT(U),3);case 3:return B.return();case 2:T=g.J(c);for(E=T.next();!E.done;E=T.next())L=E.value,$Qw(L,2);g.J3(B,4,5);return g.x(B,pPY(d,c.map(function(f){return f.action})),7);
case 7:r=B.Y,l=g.J(c),P=l.next();case 8:if(P.done){B.uY(10);break}V=P.value;v=r.get(V.action);return g.x(B,NKw(U,V,v),9);case 9:P=l.next();B.uY(8);break;case 10:WDm(U.Y,A);case 5:g.Rc(B);U.j=void 0;g.xl(B,6);break;case 4:return H=g.XE(B),cQ("Orchestration error",H),g.J3(B,12),g.x(B,tnL(U,c),14);case 14:g.t3(B,5);break;case 12:G=g.XE(B);cQ("Orchestration retry error",G);F=g.J(c);for(N=F.next();!N.done;N=F.next())e=N.value,e.retryScheduleIndex<3&&Gxj(U.Y,[e]);B.uY(5);break;case 6:return g.x(B,juT(U),
0)}})},NKw=function(U,Y,A){var c,d,T,E,L,r,l,P,V,v,H,G;
return g.S(function(F){switch(F.T){case 1:c=Y.retryScheduleIndex+2===3;if(A.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){F.uY(2);break}if(A.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){F.uY(0);break}vcT(Y,A,c);if(A.Y&&Y.retryScheduleIndex+1<3)return g.x(F,tnL(U,[Y]),0);T=((d=A)==null?0:d.T)?A.T:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";E={entityKey:Y.action.entityKey,failureReason:T};L=void 0;g.Cs(U.MI)?L="mainVideoDownloadStateEntity":g.pV(U.MI)&&(L="musicTrackDownloadMetadataEntity");
if(!L||!A.downloadState){F.uY(7);break}r=g.Uk(Y.action.entityKey).entityId;return g.x(F,Vs(r,L,U.T,A.downloadState),7);case 7:Tn(U.G,E);if(A.downloadState==="DOWNLOAD_STATE_FAILED"&&U.MI.S("html5_auto_retry_failed_pde_actions")){F.uY(0);break}cQ("Orchestration result is not retryable, deleting action");return g.x(F,L3w(U.T,wi(Y).key),0);case 2:l=void 0;try{l=(P=A.j)==null?void 0:P.map(function(N){return U.createAction(N,Y)})}catch(N){return vcT(Y,A,c),V={entityKey:Y.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},Tn(U.G,V),cQ("Orchestration subactions creation error",N),F.return()}vcT(Y,A,c,l);if(!l){F.uY(12);break}v=l.map(function(N){return wi(N)});
H=0;case 13:if(!(H<l.length)||U.K){F.uY(15);break}return g.x(F,IA(U.T,{mode:"readwrite",kt:!0},function(N){var e=[];e.push(C7o(N,v.slice(H,H+10),"offlineOrchestrationActionWrapperEntity"));return g.NC.all(e)}),16);
case 16:H+=10;F.uY(13);break;case 15:if(U.K)return U.K=!1,F.return();case 12:return G=wi(Y),g.x(F,L3w(U.T,G.key),17);case 17:$Qw(Y,4),g.i8(F)}})},kxI=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H;
return g.S(function(G){A=[];c=Infinity;d=4E3;T=g.J(Y);for(E=T.next();!E.done;E=T.next())L=E.value,r=Number(L.enqueueTimeSec),l=efq(r),P=L.retryScheduleIndex,V=P!=null&&P>0,l>0&&V?(c=Math.min(c,r),d=Math.min(l,d)):A.push(L);isFinite(c)&&(!U.W.isActive()||c<U.Z)&&(U.Z=c,U.W.start(d));U.J.gY()||(v=A.length,A=A.filter(function(F){var N;F=((N=F.actionProto)==null?void 0:N.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!BKm.includes(F)}),H=A.length<v,!U.W.isActive()&&H&&U.W.start(1));
A.length>0&&XFj(U,A);return g.x(G,JTw(U),0)})},aUo=function(U){var Y,A,c,d,T,E,L;
return g.S(function(r){if(r.T==1)return g.x(r,Rfm(U),2);Y=r.Y;A=[];c=g.J(Y);for(d=c.next();!d.done;d=c.next())T=d.value,E=g.Uk(T.key),L=E.entityId,wFW(U.Y,L)||A.push(T);return g.x(r,kxI(U,A),0)})},efq=function(U){U=U*1E3-Date.now();
return U>4E3?4E3:U},tnL=function(U,Y){var A,c,d;
return g.S(function(T){A=g.J(Y);for(c=A.next();!c.done;c=A.next()){d=c.value;var E=void 0,L=void 0,r=((L=d.action)==null?void 0:(E=L.actionMetadata)==null?void 0:E.retryScheduleIntervalsInSeconds)||[1,2,4];E=1;d.retryScheduleIndex<r.length&&(E=r[d.retryScheduleIndex]);d.Y=E*1E3+Date.now();d.retryScheduleIndex++}return g.x(T,xQO(U,Y),0)})},iZw=function(U){var Y;
return g.S(function(A){if(A.T==1)return g.x(A,q$(U.T,"offlineOrchestrationActionWrapperEntity"),2);Y=A.Y;return g.x(A,kxI(U,Y),0)})},XFj=function(U,Y){Y.length!==0&&Y.forEach(function(A){A=WQ(A);
A.retryScheduleIndex<3&&Gxj(U.Y,[A])})},Rfm=function(U,Y){var A;
return g.S(function(c){if(c.T==1)return g.x(c,q$(U.T,"offlineOrchestrationActionWrapperEntity",Y),2);A=c.Y;return c.return(A.filter(H_z))})},xQO=function(U,Y){if(Y.length===0)return Promise.resolve([]);
Y=Y.map(function(A){return wi(A)});
return zNo(U.T,Y)},sum=function(U){this.gW=U;
this.Y=void 0},fUo=function(U,Y){var A,c,d,T;
return g.S(function(E){A=Y.videoId;c=!0;if(Y.captionTracks.length)d=IOO(Y),U.Y=new g.$V(U.gW,Y,d);else if(Y.Ix)T=g.tQ3(Y),U.Y=new g.Hg(U.gW,Y.Ix,A,T,Y.FB,Y.eventId),c=Y.FB;else return E.return();return E.return(new Promise(function(L){var r;(r=U.Y)==null||r.Zy({CF:function(){return g.S(function(l){if(l.T==1)return g.x(l,U.CF(A,c),2);L();g.i8(l)})},
hQ:function(){}})}))})},hfm=function(U){var Y;
return g.S(function(A){if(A.T==1)return g.x(A,Jjz(U),2);Y=A.Y;return A.return(!!Y&&Y.length>0)})},pP=function(U){g.p.call(this);
this.Y=U;this.T=this.Y.observe(this.W.bind(this))},S4m=function(U,Y){var A,c,d,T,E,L,r;
return g.S(function(l){switch(l.T){case 1:if(Y.length===0)return l.return([]);A=Y.map(function(P){return g.YX(P,"transfer")});
return g.x(l,q$(U.Y,"transfer",A),2);case 2:c=l.Y;d=c.filter(H_z).map(function(P){return g.Uk(P.key).entityId});
T=Y.filter(function(P){return d.indexOf(P)===-1});
if(T.length===0)return l.return([]);E=g.J(T);L=E.next();case 3:if(L.done){l.uY(5);break}r=L.value;return g.x(l,UQF(r),4);case 4:L=E.next();l.uY(3);break;case 5:return l.return(T)}})},pFq=function(U,Y,A,c,d,T){var E,L,r;
return g.S(function(l){E="STREAM_TYPE_UNKNOWN";A.video&&A.audio?(E="STREAM_TYPE_AUDIO_AND_VIDEO",cQ("unexpected stream type")):A.video&&!A.audio?E="STREAM_TYPE_VIDEO":!A.video&&A.audio&&(E="STREAM_TYPE_AUDIO");L=g.YX(Y,"offlineVideoStreams");r={numBytesDownloaded:d.toFixed(),numTotalBytes:T.toFixed(),streamType:E,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(c),itag:E==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(A.itag):void 0};return g.x(l,IA(U,{mode:"readwrite",kt:!0},
function(P){var V=Zv(P,L,"offlineVideoStreams"),v=Zv(P,g.YX(Y,"transfer"),"transfer");return g.NC.all([V,v]).then(function(H){H=g.J(H);var G=H.next().value;H=H.next().value;if(!H)return y3(P,L).then(function(){});
var F=MnI(G);G=bZO(G,c,r,L);var N=g0(P,G,"offlineVideoStreams");MnI(G)>F&&(H.lastProgressTimeMs=Date.now().toString());F=[N];H.offlineVideoStreams||(H.offlineVideoStreams=[]);H.offlineVideoStreams.indexOf(L)===-1&&(H.offlineVideoStreams.push(L),F.push(g0(P,H,"transfer")));return g.NC.all(F)})}),0)})},QuY=function(U,Y){var A,c,d,T,E;
return g.S(function(L){if(L.T==1)return A=g.YX(Y,"offlineVideoStreams"),g.x(L,Kt(U,A,"offlineVideoStreams"),2);c=L.Y;if(!c||!c.streamsProgress)return L.return();d=g.J(c.streamsProgress);for(T=d.next();!T.done;T=d.next())E=T.value,E.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",E.numTotalBytes!==E.numBytesDownloaded&&(E.numBytesDownloaded=E.numTotalBytes);return g.x(L,u_(U,c,"offlineVideoStreams"),0)})},bZO=function(U,Y,A,c){if(U&&U.streamsProgress){c=U;
a:{Y=Y.itag+";"+Y.xtags;for(var d=U.streamsProgress,T=0;T<d.length;T++){var E=JSON.parse(d[T].formatStreamBytes);if(E.itag+";"+E.xtags===Y){d[T]=A;A=d;break a}}d.push(A);A=d}c.streamsProgress=A}else U={key:c,streamsProgress:[A]};return U},MnI=function(U){if(U==null?0:U.streamsProgress){var Y=0;
U=U.streamsProgress;for(var A=0;A<U.length;A++){var c=U[A];isNaN(Number(c.numBytesDownloaded))?cQ("stream progress bytes number invalid"):Y+=Number(c.numBytesDownloaded)}return Y}return 0},ZZL=function(U,Y,A,c){g.p.call(this);
var d=this;this.T=U;this.api=Y;this.yJ=A;this.Hw=c;this.J=new g.uz;this.j=new g.IM(function(){d.Y&&d.Y.transferState==="TRANSFER_STATE_TRANSFERRING"&&d.J.gY()&&((d.Y.transferRetryCount||0)<3?Mu(d.G,d.K,!1,!1):SZ(d.G,d.K.videoDetails.videoId),d.vI("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.Pw=this.QJ=0;this.X=this.Z=!1;this.dW=g.H_(this.api.L().experiments,"html5_transfer_processing_logs_interval");this.kE=new g.Qy(this);this.o5={Jcn:function(){return d.j},
CnI:function(){return d.Hw},
Fw:function(){return d.J}};
this.ov=this.T.observe(this.y7.bind(this));this.G=new CQm(Y,this);this.Zf=new sum(Y);this.jX=new pP(this.T);this.Uv=this.J.listen("publicytnetworkstatus-online",this.nj.bind(this));this.eX=this.J.listen("publicytnetworkstatus-offline",this.GsX.bind(this));this.X=this.api.L().S("html5_less_transfer_processing_logs");g.Z(this,this.kE);this.kE.N(Y,"offlinetransferpause",this.yes);g.Cs(this.api.L())?this.W="mainVideoDownloadStateEntity":g.pV(this.api.L())&&(this.W="musicTrackDownloadMetadataEntity")},
OZY=function(U){return g.S(function(Y){if(Y.T==1)Y=g.x(Y,wLz(),2);
else{var A=U.jX;var c=g.a$();c=Object.keys(c);A=S4m(A,c);Y=g.x(Y,A,0)}return Y})},Z9=function(U,Y){Y=Y===void 0?!1:Y;
var A;return g.S(function(c){if(c.T==1){if(U.Y)throw Error("Already downloading a video");U.Pw=0;U.Z=!1;return g.x(c,mQT(U),2)}return c.T!=4?(A=c.Y,gUL(U.yJ,!A),A&&U.J.gY()?Y?g.x(c,new Promise(function(d){g.vn(d,1E3)}),4):c.uY(4):(!A&&U.Y&&Qs(U),c.uY(0))):g.x(c,gcj(U,A),0)})},yTz=function(U){return g.S(function(Y){if(Y.T==1)return U.K?g.x(Y,SZ(U.G,U.K.videoDetails.videoId),3):Y.uY(0);
Qs(U);g.i8(Y)})},ncY=function(U,Y){var A,c,d;
return g.S(function(T){switch(T.T){case 1:return g.J3(T,2),(A=!!Y.captionTracks.length||!!Y.Ix)?g.x(T,hfm(Y.videoId),4):T.return();case 4:return(c=T.Y)?T.return():g.x(T,fUo(U.Zf,Y),5);case 5:g.t3(T,0);break;case 2:d=g.XE(T),cQ("Caption downloading error",d,Y.cotn),g.i8(T)}})},gcj=function(U,Y){var A,c,d,T,E,L;
return g.S(function(r){switch(r.T){case 1:if(U.Z)return r.return();U.Z=!0;U.Y=Y;A=g.Uk(U.Y.key);c=A.entityId;d=void 0;if(U.Y.transferState==="TRANSFER_STATE_TRANSFERRING")return g.x(r,Om(U,c),7);if(U.Y.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||U.Y.transferRetryCount||U.Y.hasLoggedFirstStarted){r.uY(3);break}return g.x(r,Om(U,c),5);case 5:return d=r.Y,U.Y.hasLoggedFirstStarted=!0,g.x(r,DQo(U),6);case 6:nUO({videoId:c,sR:U.Y,offlineModeType:d},void 0,void 0,!0);r.uY(3);break;case 7:d=r.Y,
zn({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:c,sR:U.Y,offlineModeType:d});case 3:return g.x(r,IUO(U),8);case 8:return T=null,g.J3(r,9),g.x(r,u7j(U,Y),11);case 11:T=r.Y;U.K=T;g.t3(r,10);break;case 9:return E=g.XE(r),cQ("error getting player response",E,Y.cotn),g.x(r,U.vI("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return r.return();case 10:return L=Uvz(U.api.L(),Y.cotn,T),g.x(r,ncY(U,L),13);case 13:return g.x(r,Y4m(L.videoId),
14);case 14:L.UB=r.Y,TKO(U.G,L,Y.maximumDownloadQuality),U.j.start(108E5),g.i8(r)}})},mQT=function(U){var Y,A;
return g.S(function(c){if(c.T==1)return g.x(c,q$(U.T,"transfer"),2);Y=c.Y;A=Y.filter(KDf).sort(q4L);return A.length===0?c.return():c.return(A[0])})},IUO=function(U){var Y,A,c;
return g.S(function(d){if(d.T==1){if(!U.Y)return mh(U,"onTransferStart"),d.return();U.j.start(108E5);return g.x(d,gi(U,"TRANSFER_STATE_TRANSFERRING"),2)}Y=U.Y;return(c=((A=Y)==null?0:A.key)?g.Uk(Y.key).entityId:"")&&U.W?g.x(d,Vs(c,U.W,U.T,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):d.uY(0)})},cTz=function(U){var Y,A,c,d;
g.S(function(T){switch(T.T){case 1:if(!U.Y){mh(U,"onTransferPausedByUser");T.uY(2);break}Y=U.Y;U.j.stop();return g.x(T,gi(U,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:c=((A=Y)==null?0:A.key)?g.Uk(Y.key).entityId:"";if(!c||!U.W){T.uY(4);break}return g.x(T,Vs(c,U.W,U.T,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.x(T,Om(U,c),6);case 6:d=T.Y,I_O({videoId:c,sR:Y,offlineModeType:d});case 2:Qs(U),Z9(U),g.i8(T)}})},dQW=function(U){var Y,A,c;
g.S(function(d){if(d.T==1){if(!U.Y)return mh(U,"onTransferPausedByNetwork"),d.return();U.j.stop();return g.x(d,gi(U,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(d.T!=3)return Y=U.Y,(c=((A=Y)==null?0:A.key)?g.Uk(Y.key).entityId:"")&&U.W?g.x(d,Vs(c,U.W,U.T,"DOWNLOAD_STATE_PAUSED"),3):d.uY(3);Qs(U);g.i8(d)})},Cgj=function(U){var Y,A,c,d,T;
g.S(function(E){switch(E.T){case 1:if(!U.Y)return mh(U,"onTransferComplete"),E.return();Y=U.Y;U.j.stop();if(!Y||!U.K){E.uY(2);break}A=Uvz(U.api.L(),Y.cotn,U.K);return g.x(E,ncY(U,A),2);case 2:return g.x(E,gi(U,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:d=((c=Y)==null?0:c.key)?g.Uk(Y.key).entityId:"";if(!d||!U.W){E.uY(5);break}return g.x(E,Vs(d,U.W,U.T,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.x(E,QuY(U.T,d),7);case 7:return g.x(E,Om(U,d),8);case 8:T=E.Y,zn({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:d,sR:Y,offlineModeType:T}),Qs(U),Z9(U),g.i8(E)}})},UYI=function(U,Y,A){var c,d;
g.S(function(T){switch(T.T){case 1:if(!U.Y)return mh(U,"onTransferProgress: "+Y),T.return();if(U.Y.transferState==="TRANSFER_STATE_TRANSFERRING"){T.uY(2);break}return g.x(T,IUO(U),2);case 2:c=Date.now();if(!(c-U.QJ>1E3)){T.uY(4);break}U.QJ=c;return g.x(T,pFq(U.T,A.videoId,A.T,A.By,A.bytesDownloaded,A.Y),5);case 5:if(U.X&&!(U.X&&c-U.Pw>U.dW)){T.uY(4);break}U.Pw=c;return g.x(T,Om(U,Y),7);case 7:d=T.Y,nUO({videoId:Y,sR:U.Y,offlineModeType:d},A.bytesDownloaded,A.Y);case 4:U.j.start(108E5),g.i8(T)}})},
Y3m=function(U){var Y=(U.Y.transferRetryCount||0)<3;
Y&&(U=U.Y,U.transferRetryCount=(U.transferRetryCount||0)+1);return Y},Aaz=function(U,Y){Y=Y===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":Y;
var A,c,d,T;return g.S(function(E){if(E.T==1)return U.Y||mh(U,"setTransferToFailed: "+Y),A="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Y==="TRANSFER_FAILURE_REASON_NETWORK"?A="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":Y==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(A="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.x(E,gi(U,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",Y),2);if(E.T!=3)return Tn(U.Hw,{entityKey:(c=U.Y)==null?void 0:c.key,failureReason:A}),
d=U.Y?g.Uk(U.Y.key).entityId:"",g.x(E,Om(U,d),3);T=E.Y;var L={videoId:d,sR:U.Y,offlineModeType:T},r=Y,l={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};r&&(l.transferFailureReason=r,l.failureReason=uJL(r));zn(l,L);g.i8(E)})},gi=function(U,Y,A,c){var d;
return g.S(function(T){if(T.T==1){if(!U.Y)return mh(U,"saveTransferState: "+Y),T.return();U.Y.transferState=Y;U.Y.failureReason=c;g.J3(T,2);return g.x(T,DQo(U,function(E){return A?OK(E,"offlineVideoStreams",U.Y.offlineVideoStreams).then(function(L){for(var r=g.J(L),l=r.next();!l.done;l=r.next())if((l=l.value)&&l.streamsProgress){l=g.J(l.streamsProgress);for(var P=l.next();!P.done;P=l.next())P.value.streamState=A}return C7o(E,L.filter(function(V){return!!V}),"offlineVideoStreams")}):g.NC.resolve(void 0)}),
4)}if(T.T!=2)return g.t3(T,0);
d=g.XE(T);return d instanceof g.G1&&d.type==="QUOTA_EXCEEDED"?g.x(T,U.vI("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):T.uY(0)})},DQo=function(U,Y){var A;
return g.S(function(c){if(!U.Y)return c.return();A=U.Y;return g.x(c,IA(U.T,{mode:"readwrite",kt:!0},function(d){var T=[g0(d,A,"transfer")];Y&&T.push(Y(d));return g.NC.all(T)}),0)})},Qs=function(U){U.Y=void 0;
U.K=void 0;U.j.stop()},u7j=function(U,Y){var A,c,d,T,E;
return g.S(function(L){if(L.T==1)return A=g.Uk(Y.key),c=A.entityId,d=g.YX(c,"playbackData"),g.x(L,Kt(U.T,d,"playbackData"),2);T=L.Y;if((E=T)==null?0:E.playerResponseJson)return L.return(JSON.parse(T.playerResponseJson));throw Error("No PlayerResponse found");})},mh=function(U,Y){U.api.wW("woffle",{mcte:Y});
cQ("missing current transfer entity.")},Om=function(U,Y){var A,c,d;
return g.S(function(T){if(T.T==1)return g.x(T,Kt(U.T,g.YX(Y,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);A=T.Y;return T.return((d=(c=A)==null?void 0:c.offlineModeType)!=null?d:void 0)})},KDf=function(U){return caj[U.transferState]!==void 0},q4L=function(U,Y){var A=caj[U.transferState],c=caj[Y.transferState];
return A!==c?A-c:Number(U.enqueuedTimestampMs)-Number(Y.enqueuedTimestampMs)},ys=function(U,Y){var A=this;
this.MI=U;this.api=Y;this.J=new g.uz;this.K=new g.VI;this.o5={D8:function(){return A.W.o5.D8()},
Fw:function(){return A.J},
Vvy:function(){return A.W},
oK:function(){return A.oK()},
SR:function(){return A.SR()},
yk:function(){return A.yk()},
Zx:function(){return A.Zx()},
B$:function(){return A.B$()},
O2:function(c){return A.O2(c)}};
this.W=new Q_f(function(){return dYo(A)},function(){A.yk()},this.api.NA(),this.api.S.bind(this.api));
this.Y=new di(this.api);Z_m(this.W)},dYo=function(U){return g.S(function(Y){U.api.Ev("onOrchestrationBecameLeader");
return g.x(Y,U.SR(),0)})},E4o=function(U){var Y,A;
return g.S(function(c){if(c.T==1)return g.x(c,Ct(),2);if(c.T!=3){Y=c.Y;if(!Y)return cQ("PES is undefined"),c.return();U.T=new ZZL(Y,U.api,U.W,U.Y);A=U.e3(Y);return g.x(c,FDo(Y,A,U.W,U.Y,U.MI),3)}U.G=c.Y;return g.x(c,T5Y(U),0)})},T5Y=function(U){var Y;
return g.S(function(A){switch(A.T){case 1:if(!U.T)return cQ("transferManager is undefined"),A.return();if(U.T.Y){A.uY(2);break}return g.x(A,Z9(U.T),2);case 2:if(!U.MI.S("woffle_enable_main_downloads_library")){A.uY(4);break}return g.x(A,U.eC(),4);case 4:if(!U.MI.S("html5_offline_playback_position_sync")){A.uY(6);break}return g.x(A,U.p8(),7);case 7:return g.x(A,U.O2(864E5),6);case 6:return g.x(A,U.refreshAllStaleEntities(43200,!0),9);case 9:return g.x(A,U.bV(),10);case 10:if(!U.MI.S("html5_retry_downloads_for_expiration")){A.uY(11);
break}return g.x(A,U.B$(),11);case 11:return U.Z=g.Hn(function(){U.refreshAllStaleEntities(43200,!0);U.bV()},9E5),g.CU(g.Y6(),function(){return U.Zx()}),g.x(A,Ct(),13);
case 13:return Y=A.Y,g.x(A,pLY(Y),14);case 14:O_L(U.W),g.i8(A)}})},o4T=function(){var U,Y,A,c,d,T;
return g.S(function(E){switch(E.T){case 1:return g.x(E,Ct(),2);case 2:U=E.Y;if(!U)return E.return([]);Y=Date.now()/1E3;return g.x(E,q$(U,"offlineVideoPolicy"),3);case 3:A=E.Y,c=g.J(A),d=c.next();case 4:if(d.done){E.uY(6);break}T=d.value;if(!(T.expirationTimestamp&&Number(T.expirationTimestamp)<Y)){E.uY(5);break}T.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";T.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.x(E,u_(U,T,"offlineVideoPolicy"),5);
case 5:d=c.next();E.uY(4);break;case 6:return E.return(A.map(function(L){return L.key}))}})},nP=function(U,Y,A,c,d){var T,E,L;
return g.S(function(r){if(r.T==1)return g.x(r,Ct(),2);T=r.Y;if(!T)return r.return([]);E=Y.map(function(l){var P=g.YX(l,A);P={actionType:c,entityKey:P,actionMetadata:Object.assign({},YAf(),d)};c!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(P.actionMetadata.priority=0);l=new Gn(A,l,P);return wi(l)});
L=zNo(T,E);Z_m(U.W);return r.return(L)})},zew=function(U,Y,A,c){var d,T,E,L,r,l,P,V;
return g.S(function(v){switch(v.T){case 1:d=[],T=g.J(Y),E=T.next();case 2:if(E.done){v.uY(4);break}L=E.value;if(L.upToDate||A&&!L.shouldAutoSyncMetadata||!L.playlistId){v.uY(3);break}r={};switch(c){case "mainPlaylistEntity":l={nextAutoRefreshIntervalSeconds:L.checkInSeconds,autoSync:A};r={mainPlaylistEntityActionMetadata:l};break;case "musicPlaylist":P={autoSync:A},r={musicPlaylistEntityActionMetadata:P}}return g.x(v,nP(U,[L.playlistId],c,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",r),6);case 6:(V=
v.Y)&&d.push.apply(d,g.X(V));case 3:E=T.next();v.uY(2);break;case 4:return v.return(d)}})},LOz=function(U,Y){var A;
return g.S(function(c){return Y.length?(A=YAf(),g.OZ(A,fP,{isEnqueuedForExpiredStreamUrlRefetch:!0}),U.api.wW("qrd",{v:Y.length}),c.return(nP(U,Y,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",A))):c.return([])})},raz=function(U,Y,A){this.Y=U;
this.MI=Y;this.W=A},VTm=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B;
return g.S(function(f){switch(f.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,T=[],g.J3(f,2),g.x(f,lQI(U,d),4);case 4:T=f.Y;if(!(U.MI.S("woffle_enable_main_downloads_library")&&((E=T)==null?0:E.length))){f.uY(5);break}return g.x(f,$vf(U.Y,[Y.entityKey]),5);case 5:g.t3(f,3);break;case 2:return L=g.XE(f),r="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",L instanceof g.G1&&L.type==="QUOTA_EXCEEDED"?(r="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
l="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):cQ("Playlist add error"),f.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,r,l));case 3:P=[];if(!U.MI.S("html5_offline_prevent_redownload_downloaded_video")){f.uY(7);break}return g.x(f,CFW(U.Y,"mainVideoEntity",T),8);case 8:T=f.Y;case 7:if((V=T)==null?0:V.length)for(v=g.J(T),H=v.next();!H.done;H=v.next())if(G=H.value,F=G.offlineVideoData,N=void 0,(N=F)==null?0:N.videoId)e=void 0,B=Number(((e=Y.actionMetadata)==null?void 0:e.priority)||
0)+1,P.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",F.videoId,"mainVideoEntity",B,D9,Peo(Y,F,d)));return f.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,P))}})},v4w=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL,Rm,vW,b8,hq,am,k,R,a,b,m,N4,A3,W3,dX,ac,KY,jz,NV,fa,n6,na,Dp,F1,$Z,ag,G$,xO,OR,m$,B7,T$,Ix,zd,RM,yw;
return g.S(function(WG){switch(WG.T){case 1:return A=LP(Y),c=Y.entityKey,d=g.Uk(c).entityId,T=[],E=!1,d==="!*$_ALL_ENTITIES_!*$"?(E=!0,g.x(WG,q$(U.Y,"mainPlaylistEntity"),5)):g.x(WG,Kt(U.Y,c,"mainPlaylistEntity"),4);case 4:(L=WG.Y)&&T.push(L);WG.uY(3);break;case 5:T=WG.Y;case 3:if((r=T)==null||!r.length)return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));l=g.O(Y.actionMetadata,$YY);V=(P=l)==null?void 0:P.nextAutoRefreshIntervalSeconds;H=(v=l)==null?void 0:v.autoSync;G=[];N=F=
!0;e=!1;if(!E&&H===!1){WG.uY(6);break}g.J3(WG,7);return g.x(WG,XPq(0,!!H,!0,T),9);case 9:G=WG.Y;g.t3(WG,8);break;case 7:B=g.XE(WG);if(!(B instanceof Error&&B.message==="No data")){B instanceof Error&&B.message==="Empty response body"&&cQ(B.message);WG.uY(8);break}return d==="!*$_ALL_ENTITIES_!*$"?g.x(WG,zpq(U.Y,Y,U.W,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.x(WG,ECw(d,U.Y,Y,U.W),8);case 8:if(!G.length||!E&&G[0].playlistId!==d)return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A));case 6:if(E){f=[];h=g.J(G);for(Q=h.next();!Q.done;Q=h.next())K=Q.value,K.upToDate||H&&!K.shouldAutoSyncMetadata||!K.playlistId||(D={nextAutoRefreshIntervalSeconds:K.checkInSeconds,autoSync:H},f.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",K.playlistId,"mainPlaylistEntity",0,D9,{mainPlaylistEntityActionMetadata:D})));return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,f))}G.length&&(c3=G[0],e=!!c3.upToDate,H&&(F=(TV=c3.shouldAutoSyncMetadata)!=null?TV:!0,N=(U9=c3.shouldAutoSyncVideos)!=
null?U9:!0,c3.checkInSeconds&&(V=c3.checkInSeconds)));if(e||!F)return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));LY=[];q=T[0];if(!q.downloadState){FE=void 0;WG.uY(15);break}return g.x(WG,Kt(U.Y,q.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:FE=WG.Y;case 15:return B3=FE,tq=((O9=B3)==null?0:O9.addedTimestampMillis)?String(B3.addedTimestampMillis):void 0,g.J3(WG,17),g.x(WG,lQI(U,d,tq,V),19);case 19:LY=WG.Y;g.t3(WG,18);break;case 17:Lj=g.XE(WG);if(!(Lj instanceof
Error&&Lj.message==="No data for playlist")){if(Lj instanceof Error&&Lj.message==="Empty response body for playlist")cQ(Lj.message);else return kl="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",eS="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Lj instanceof g.G1&&Lj.type==="QUOTA_EXCEEDED"&&(kl="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",eS="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,kl,eS));
WG.uY(18);break}return g.x(WG,ECw(d,U.Y,Y,U.W),18);case 18:if(!N)return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));To=[];t=new Map;if((zV=LY)==null?0:zV.length)for(Im=g.J(LY),jL=Im.next();!jL.done;jL=Im.next())Rm=jL.value,vW=Rm.offlineVideoData,b8=void 0,((b8=vW)==null?0:b8.videoId)&&t.set(vW.videoId,vW);hq=new Map;am=[];if((k=q)==null?0:(R=k.videos)==null?0:R.length)for(a=g.J(q.videos),b=a.next();!b.done;b=a.next())if(m=b.value,N4=JSON.parse(g.Uk(m).entityId),A3=N4.videoId)t.has(A3)?
(hq.set(A3,t.get(A3)),t.delete(A3)):am.push(A3);dX=Number(((W3=Y.actionMetadata)==null?void 0:W3.priority)||0)+1;ac=g.J(t.entries());for(KY=ac.next();!KY.done;KY=ac.next())jz=KY.value,NV=g.J(jz),fa=NV.next().value,n6=NV.next().value,na=fa,Dp=n6,To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",na,"mainVideoEntity",dX,D9,Peo(Y,Dp,d)));F1=g.J(hq.entries());for($Z=F1.next();!$Z.done;$Z=F1.next())ag=$Z.value,G$=g.J(ag),xO=G$.next().value,OR=G$.next().value,m$=xO,B7=OR,To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
m$,"mainVideoEntity",dX,D9,Peo(Y,B7,d)));T$=g.J(am);for(Ix=T$.next();!Ix.done;Ix=T$.next())zd=Ix.value,RM={playlistId:d},yw={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:RM},To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",zd,"mainVideoEntity",0,D9,yw));return WG.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,To))}})},HFW=function(U,Y){var A,c,d,T;
return g.S(function(E){switch(E.T){case 1:return A=LP(Y),g.J3(E,2),c=g.Uk(Y.entityKey).entityId,c==="!*$_ALL_ENTITIES_!*$"?g.x(E,zpq(U.Y,Y,U.W,(d=Y.actionMetadata)==null?void 0:(T=d.offlineLoggingData)==null?void 0:T.offlineDeleteReason),5):g.x(E,ECw(c,U.Y,Y,U.W),6);case 6:if(!U.MI.S("woffle_enable_main_downloads_library")){E.uY(5);break}return g.x(E,vCT(U.Y,Y.entityKey),5);case 5:g.t3(E,3);break;case 2:return g.XE(E),E.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return E.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A))}})},lQI=function(U,Y,A,c){var d,T,E,L,r,l,P;
return g.S(function(V){switch(V.T){case 1:return g.x(V,epW([Y]),2);case 2:return d=V.Y,g.x(V,Gjf(U,d[0],A,c),3);case 3:return T=V.Y,E=T.mainPlaylistEntity,L=T.bVI,l=dvF(E,(r=L)==null?void 0:r.avatar),g.J3(V,4),g.x(V,Js(l),6);case 6:g.t3(V,5);break;case 4:P=g.XE(V),P instanceof Error&&P.message==="Failed to fetch"&&cQ(P.message);case 5:return V.return(d[0].videos)}})},Gjf=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h;
return g.S(function(Q){switch(Q.T){case 1:d=Date.now().toString();A||(A=d);T=Y.videos;E=Y.playlistId;L=[];r=[];if(T)for(l=g.J(T),P=l.next();!P.done;P=l.next()){V=P.value;v=V.offlineVideoData;if(!v||!v.videoId)throw cQ("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");H=v.videoId;G={videoId:H,playlistId:E};F={id:g.YX(JSON.stringify(G),"mainPlaylistVideoEntity"),video:g.YX(H,"mainVideoEntity")};L.push(F);r.push(F.id)}e={key:g.YX(E,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:A,lastSyncedTimestampMillis:d};B={key:g.YX(E,"mainPlaylistEntity"),playlistId:E,videos:r,title:Y.title,thumbnailStyleData:WOo(Y),visibility:wuw(Y),downloadState:e.key};Y.channel&&(f=Y.channel.offlineChannelData,N=iFz(g.YX(E,"ytMainChannelEntity"),f),B.channelOwner=N.id);((h=B)==null?0:h.entityMetadata)?(B.entityMetadata.offlineLastModifiedTimestampSeconds=Y.lastModifiedTimestamp,c&&(B.entityMetadata.nextAutoRefreshIntervalSeconds=String(c))):B&&(B.entityMetadata={nextAutoRefreshIntervalSeconds:c?
String(c):void 0,offlineLastModifiedTimestampSeconds:Y.lastModifiedTimestamp});g.J3(Q,2);return g.x(Q,IA(U.Y,{mode:"readwrite",kt:!0},function(K){var D=g0(K,B,"mainPlaylistEntity"),c3=g0(K,e,"mainPlaylistDownloadStateEntity");D=[D,c3];c3=g.J(L);for(var TV=c3.next();!TV.done;TV=c3.next())D.push(g0(K,TV.value,"mainPlaylistVideoEntity"));N&&D.push(g0(K,N,"ytMainChannelEntity"));return g.NC.all(D)}),4);
case 4:g.t3(Q,3);break;case 2:throw g.XE(Q),cQ("PES failure for playlist"),Error("PES failure for playlist");case 3:return Q.return({mainPlaylistEntity:B,bVI:N,uEv:L})}})},iFz=function(U,Y){return{id:U,
channelId:Y.channelId,title:Y.title,avatar:Y.thumbnail}},WOo=function(U){var Y=[],A=U.videos;
A&&A.length>0&&Y.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:A[0].offlineVideoData.thumbnail}}});if((U=U.additionalMetadadatas)&&U.length>0)for(U=g.J(U),A=U.next();!A.done;A=U.next()){var c=A.value.offlineBundleItemPlaylistData,d=void 0;A=(d=c)==null?void 0:d.style;d=void 0;c={collageThumbnail:{coverThumbnail:(d=c)==null?void 0:d.coverThumbnail}};switch(A){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":Y.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:c});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":Y.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:c});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":Y.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:c});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":Y.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:c})}}return Y},wuw=function(U){switch(U.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},Peo=function(U,Y,A){Y={offlineVideoData:Y,
playlistId:A};if(U=g.O(U.actionMetadata,$YY))Y.maximumDownloadQuality=U.maximumDownloadQuality;return{mainVideoEntityActionMetadata:Y}},Jaq=function(U,Y,A){this.Y=U;
this.MI=Y;this.W=A},N5m=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G;
return g.S(function(F){switch(F.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,T=g.O(Y.actionMetadata,II),L=!((E=T)==null?0:E.playlistId),g.J3(F,2),g.x(F,FOj(U,d,void 0,(r=T)==null?void 0:r.offlineVideoData,L),4);case 4:g.t3(F,3);break;case 2:return l=g.XE(F),P="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",V="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",l instanceof g.G1&&l.type==="QUOTA_EXCEEDED"&&(P="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",V="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
F.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,P,V));case 3:v=1;v=Number(((H=Y.actionMetadata)==null?void 0:H.priority)||0)+1;var N=(N=g.O(Y.actionMetadata,II))?{playbackDataActionMetadata:{maximumDownloadQuality:N.maximumDownloadQuality}}:void 0;G=xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",d,"playbackData",v,j5F,N);return F.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,[G]))}})},tTO=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B;
return g.S(function(f){switch(f.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,g.x(f,Kt(U.Y,Y.entityKey,"mainVideoEntity"),2);case 2:T=f.Y;if(!T){E=void 0;f.uY(3);break}return g.x(f,Kt(U.Y,T.downloadState,"mainVideoDownloadStateEntity"),4);case 4:E=f.Y;case 3:L=E;if(!T||!L)return f.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));g.J3(f,5);return g.x(f,FOj(U,d,L.addedTimestampMillis,(l=g.O(Y.actionMetadata,II))==null?void 0:l.offlineVideoData),7);case 7:P=1;P=Number(((V=
Y.actionMetadata)==null?void 0:V.priority)||0)+1;r=xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",d,"playbackData",P,j5F);g.t3(f,6);break;case 5:v=g.XE(f);if(!(v instanceof Error&&v.message==="No data")){if(v instanceof Error&&v.message==="Empty response body")cQ(v.message);else return H="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",G="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",v instanceof g.G1&&v.type==="QUOTA_EXCEEDED"&&(H="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
G="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),f.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,H,G));f.uY(6);break}return g.x(f,Nu(U.Y,d),9);case 9:F=f.Y;N=g.O(Y.actionMetadata,II);if(B=(e=N)==null?void 0:e.playlistId)F.playlistId=B;F.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.x(f,Fc(d,U.Y,Y,U.W,F),6);case 6:return f.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,r?[r]:void 0))}})},eem=function(U,Y){var A,c,d,T,E,L,r,l,P,V;
return g.S(function(v){switch(v.T){case 1:return A=LP(Y),g.J3(v,2),c=g.Uk(Y.entityKey).entityId,c==="!*$_ALL_ENTITIES_!*$"?g.x(v,zpq(U.Y,Y,U.W,(P=Y.actionMetadata)==null?void 0:(V=P.offlineLoggingData)==null?void 0:V.offlineDeleteReason),5):g.x(v,Nu(U.Y,c),6);case 6:d=v.Y;T=g.O(Y.actionMetadata,II);if(L=(E=T)==null?void 0:E.playlistId)d.playlistId=L;d.offlineDeleteReason=(r=Y.actionMetadata)==null?void 0:(l=r.offlineLoggingData)==null?void 0:l.offlineDeleteReason;return g.x(v,Fc(c,U.Y,Y,U.W,d),7);
case 7:if(!U.MI.S("woffle_enable_main_downloads_library")){v.uY(5);break}return g.x(v,vCT(U.Y,Y.entityKey),5);case 5:g.t3(v,3);break;case 2:return g.XE(v),v.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return v.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A))}})},FOj=function(U,Y,A,c,d){var T,E,L,r,l,P;
return g.S(function(V){switch(V.T){case 1:if(T=c){V.uY(2);break}return g.x(V,tkf([Y]),3);case 3:E=V.Y,T=E[0];case 2:return g.x(V,B5T(U,T,A,d),4);case 4:L=V.Y;r=L.mainVideoEntity;l=L.channelEntity;g.J3(V,5);var v=HQ(r.thumbnail),H=HQ(l.avatar);return g.x(V,Js(v.concat(H)),7);case 7:g.t3(V,0);break;case 5:P=g.XE(V),P instanceof Error&&P.message==="Failed to fetch"&&cQ(P.message),g.i8(V)}})},B5T=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v,H,G,F,N;
return g.S(function(e){switch(e.T){case 1:A||(A=Date.now().toString());T=(d=Y.channel)==null?void 0:d.offlineChannelData;E={id:g.YX(Y.videoId,"ytMainChannelEntity"),channelId:T.channelId,title:T.title,avatar:T.thumbnail};L={key:g.YX(Y.videoId,"mainVideoDownloadStateEntity"),playbackData:g.YX(Y.videoId,"playbackData"),addedTimestampMillis:A,videoDownloadContextEntity:g.YX(Y.videoId,"videoDownloadContextEntity")};r={key:g.YX(Y.videoId,"videoPlaybackPositionEntity"),videoId:Y.videoId,lastPlaybackPositionSeconds:"0"};
U.MI.S("html5_offline_playback_position_sync")&&(l={playbackPosition:r.key});P=g.YX(Y.videoId,"mainVideoEntity");V={key:P,videoId:Y.videoId,title:Y.title,thumbnail:Y.thumbnail,localizedStrings:{viewCount:Y.shortViewCountText},userState:l,lengthSeconds:Y.lengthSeconds?Number(Y.lengthSeconds):void 0,publishedTimestampMillis:Y.publishedTimestamp?(Number(Y.publishedTimestamp)*1E3).toString():void 0,formattedDescription:Y.description,owner:E.id,downloadState:L.key};if(!U.MI.S("woffle_enable_main_downloads_library")||
!c){e.uY(2);break}return g.x(e,VkO(U.Y,[P]),3);case 3:if(G=e.Y)v=G.mainDownloadsLibraryEntity,H=G.mainDownloadsListEntity;case 2:return N=qvm,F={key:g.YX(Y.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.OZ(L,N,F),g.x(e,IA(U.Y,{mode:"readwrite",kt:!0},function(B){var f=g0(B,E,"ytMainChannelEntity"),h=g0(B,L,"mainVideoDownloadStateEntity"),Q=g0(B,V,"mainVideoEntity");f=[f,h,Q];U.MI.S("html5_offline_playback_position_sync")&&(h=g0(B,r,"videoPlaybackPositionEntity"),
f.push(h));v&&(h=g0(B,v,"mainDownloadsLibraryEntity"),f.push(h));H&&(h=g0(B,H,"mainDownloadsListEntity"),f.push(h));F&&(B=g0(B,F,"downloadStatusEntity"),f.push(B));return g.NC.all(f)}),4);
case 4:return e.return({mainVideoEntity:V,channelEntity:E})}})},XuY=function(U,Y,A){this.Y=U;
this.MI=Y;this.W=A},ReI=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q;
return g.S(function(FE){switch(FE.T){case 1:return A=LP(Y),c=[],g.x(FE,b_.getInstance(),2);case 2:d=FE.Y;if(!d){FE.uY(3);break}return g.x(FE,d.get("sdois"),4);case 4:return T=FE.Y,g.x(FE,(L=d)==null?void 0:L.get("lmqf"),5);case 5:E=FE.Y;case 3:g.J3(FE,6);if(T===void 0)throw Error("prefStorage or opt-in state is undefined");r=[];if(T){FE.uY(8);break}return g.x(FE,PQL(U.Y),9);case 9:r=FE.Y,r.reverse();case 8:if(!r.length){FE.uY(10);break}l=g.J(r);P=l.next();case 11:if(P.done){FE.uY(10);break}V=P.value;
if(!V){FE.uY(12);break}v=g.Uk(V).entityId;return g.x(FE,Nu(U.Y,v),14);case 14:return H=FE.Y,H.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.x(FE,Fc(v,U.Y,{entityKey:V,actionType:Y.actionType},U.W,H),12);case 12:P=l.next();FE.uY(11);break;case 10:return g.x(FE,Rpz(T,(G=E)!=null?G:"SD"),16);case 16:return F=FE.Y,g.x(FE,LIm(F),17);case 17:N=lGO(F);if(!U.MI.S("woffle_enable_main_downloads_library")){FE.uY(18);break}if(T){FE.uY(19);break}return g.x(FE,vCT(U.Y,g.sL),19);case 19:return g.x(FE,
$vf(U.Y,[g.sL]),18);case 18:if((e=N)==null?0:e.length)for(B=g.J(N),f=B.next();!f.done;f=B.next())if(Q=h=f.value,K=Q.actionType,D=Q.entityKey,c3=Q.actionMetadata,K&&D&&c3&&!g.O(c3,kjo)){K==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(c3.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(TV=g.O(h.actionMetadata,II))TV.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",h.actionMetadata=Object.assign({},h.actionMetadata,{mainVideoEntityActionMetadata:TV});c.push(h)}g.t3(FE,
7);break;case 6:return U9=g.XE(FE),LY="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",q="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",U9 instanceof g.G1&&U9.type==="QUOTA_EXCEEDED"&&(LY="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",q="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),FE.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,LY,q));case 7:return FE.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,c))}})},aQT=function(){ys.apply(this,
arguments);
this.X="mainVideoEntity"},xYo=function(U,Y,A){Y=Y===void 0?43200:Y;
A=A===void 0?!0:A;var c=c===void 0?!1:c;var d,T,E;return g.S(function(L){switch(L.T){case 1:if(!U.J.gY())return L.return([]);d=[];g.J3(L,2);return g.x(L,XPq(Y,A,c),4);case 4:d=L.Y;g.t3(L,3);break;case 2:T=g.XE(L),T instanceof Error&&T.message==="No data"||T instanceof Error&&T.message==="Empty response body"&&cQ(T.message);case 3:return E=zew(U,d,A,"mainPlaylistEntity"),L.return(E)}})},s5z=function(U,Y,A,c){c=c===void 0?!1:c;
var d,T,E,L,r,l,P,V,v,H,G,F,N,e,B;return g.S(function(f){switch(f.T){case 1:return d=[],g.x(f,k6O(),2);case 2:return(T=f.Y)||c?g.x(f,aGf(Y,A),3):f.return([]);case 3:E=f.Y;if((L=E)==null||!L.length)return f.return([]);r={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};l=g.J(E);P=l.next();case 4:if(P.done){f.uY(6);break}v=V=P.value;H=v.actionType;G=v.entityKey;F=v.actionMetadata;if(!(H&&G&&F)||g.O(F,kjo)){f.uY(5);break}H==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(F.offlineLoggingData=
r);N=g.Uk(G);e=N.entityId;return g.x(f,nP(U,[e],"mainVideoEntity",H,F),8);case 8:B=f.Y,d=d.concat(B);case 5:P=l.next();f.uY(4);break;case 6:return f.return(d)}})},fQI=function(U,Y){this.Y=U;
this.W=Y},S3f=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e;
return g.S(function(B){switch(B.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,T=[],g.J3(B,2),g.x(B,hem(U,d),4);case 4:T=B.Y;if((E=T)==null||!E.length){B.uY(5);break}return g.x(B,iBT(U.Y,Y.entityKey),5);case 5:g.t3(B,3);break;case 2:return L=g.XE(B),r="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",L instanceof g.G1&&L.type==="QUOTA_EXCEEDED"&&(r="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",l="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
B.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,r,l));case 3:return P=[],g.x(B,CFW(U.Y,"musicTrack",T),7);case 7:T=B.Y;if(T.length)for(V=g.J(T),v=V.next();!v.done;v=V.next())if(H=v.value,G=H.offlineVideoData,F=void 0,(F=G)==null?0:F.videoId)N=void 0,e=Number(((N=Y.actionMetadata)==null?void 0:N.priority)||0)+1,P.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",G.videoId,"musicTrack",e,u5,Xc(Y,G,d)));return B.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,P))}})},
MTw=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL,Rm,vW,b8,hq,am,k,R,a,b,m,N4,A3,W3,dX,ac,KY,jz,NV,fa,n6;
return g.S(function(na){switch(na.T){case 1:return A=LP(Y),c=Y.entityKey,d=g.Uk(c).entityId,T=[],E=!1,d==="!*$_ALL_ENTITIES_!*$"?(E=!0,g.x(na,q$(U.Y,"musicAlbumRelease"),5)):g.x(na,Kt(U.Y,c,"musicAlbumRelease"),4);case 4:(L=na.Y)&&T.push(L);na.uY(3);break;case 5:T=na.Y;case 3:if((r=T)==null||!r.length)return na.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));if(E){l=[];P=g.J(T);for(V=P.next();!V.done;V=P.next())v=V.value,H=g.Uk(v.id).entityId,l.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
H,"musicAlbumRelease",0,u5));return na.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,l))}G=[];F=T[0];N=void 0;if(!F.downloadMetadata){na.uY(6);break}return g.x(na,Kt(U.Y,F.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:e=na.Y,N=Number((f=(B=e)==null?void 0:B.addedTimestampMillis)!=null?f:"0")/1E3;case 6:return g.J3(na,8),g.x(na,hem(U,d,(h=N)==null?void 0:h.toString()),10);case 10:G=na.Y;g.t3(na,9);break;case 8:Q=g.XE(na);if(!(Q instanceof Error&&Q.message===
"No data")){if(Q instanceof Error&&Q.message==="Empty response body")cQ(Q.message);else return K="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",D="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Q instanceof g.G1&&Q.type==="QUOTA_EXCEEDED"&&(K="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",D="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),na.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,K,D));na.uY(9);break}return g.x(na,eZ(d,"musicAlbumRelease",U.Y,
Y,U.W),9);case 9:c3=[];TV=new Map;if((U9=G)==null?0:U9.length)for(LY=g.J(G),q=LY.next();!q.done;q=LY.next())FE=q.value,B3=FE.offlineVideoData,O9=void 0,((O9=B3)==null?0:O9.videoId)&&TV.set(B3.videoId,B3);tq=new Map;Lj=[];if((kl=F)==null?0:(eS=kl.tracks)==null?0:eS.length)for(To=g.J(F.tracks),t=To.next();!t.done;t=To.next())if(zV=t.value,Im=g.Uk(zV).entityId)TV.has(Im)?(tq.set(Im,TV.get(Im)),TV.delete(Im)):Lj.push(Im);Rm=Number(((jL=Y.actionMetadata)==null?void 0:jL.priority)||0)+1;vW=g.J(TV.entries());
for(b8=vW.next();!b8.done;b8=vW.next())hq=b8.value,am=g.J(hq),k=am.next().value,R=am.next().value,a=k,b=R,c3.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",a,"musicTrack",Rm,u5,Xc(Y,b)));m=g.J(tq.entries());for(N4=m.next();!N4.done;N4=m.next())A3=N4.value,W3=g.J(A3),dX=W3.next().value,ac=W3.next().value,KY=dX,jz=ac,c3.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",KY,"musicTrack",Rm,u5,Xc(Y,jz)));NV=g.J(Lj);for(fa=NV.next();!fa.done;fa=NV.next())n6=fa.value,c3.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
n6,"musicTrack",0,u5));return na.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,c3))}})},bFY=function(U,Y){var A,c;
return g.S(function(d){switch(d.T){case 1:return A=LP(Y),g.J3(d,2),c=g.Uk(Y.entityKey).entityId,c==="!*$_ALL_ENTITIES_!*$"?g.x(d,BQ(U.Y,Y,U.W),5):g.x(d,eZ(c,"musicAlbumRelease",U.Y,Y,U.W),6);case 6:return g.x(d,JZL(U.Y,Y.entityKey),5);case 5:g.t3(d,3);break;case 2:return g.XE(d),d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},hem=function(U,Y,A){var c,d,T;
return g.S(function(E){switch(E.T){case 1:return g.x(E,epW([Y]),2);case 2:return c=E.Y,g.x(E,puY(U,c[0],A),3);case 3:return d=E.Y,T=HQ(d.thumbnailDetails),g.x(E,Js(T),4);case 4:return E.return(c[0].videos)}})},puY=function(U,Y,A){var c,d,T,E,L,r,l,P,V,v,H,G,F,N;
return g.S(function(e){if(e.T==1){c=Y.additionalMetadadatas;d=void 0;if(c&&c.length>0)for(T=g.J(c),E=T.next();!E.done;E=T.next())if(L=E.value,L.offlineMusicPlaylistData){d=L.offlineMusicPlaylistData;break}r=Y.playlistId;l=FIf(Y);P=l.dZ;V=l.OU;v=A?(Number(A)*1E3).toString():Date.now().toString();H=Y.lastModifiedTimestamp?(Number(Y.lastModifiedTimestamp)*1E3).toString():"0";G={id:g.YX(r,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:V,lastModifiedTimestampMillis:H,addedTimestampMillis:v,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};F={id:g.YX(r,"musicAlbumRelease"),title:Y.title,audioPlaylistId:r,trackCount:Y.totalVideoCount,tracks:P,downloadMetadata:G.id};d&&(F.thumbnailDetails=(N=d.albumHqThumbnail)!=null?N:d.albumArtistThumbnail,F.artistDisplayName=d.albumArtistDisplayName,F.releaseDate=d.albumReleaseDate,F.contentRating={explicitType:d.albumReleaseExplicitType},F.releaseType=d.albumReleaseType);return g.x(e,IA(U.Y,{mode:"readwrite",kt:!0},function(B){var f=g0(B,F,"musicAlbumRelease");
B=g0(B,G,"musicAlbumReleaseDownloadMetadataEntity");return g.NC.all([f,B])}),2)}return e.return(F)})},Q5L=function(U,Y){this.Y=U;
this.W=Y},OFm=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e;
return g.S(function(B){switch(B.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,T=[],g.J3(B,2),g.x(B,ZFj(U,d),4);case 4:T=B.Y;if((E=T)==null||!E.length){B.uY(5);break}return g.x(B,iBT(U.Y,Y.entityKey),5);case 5:g.t3(B,3);break;case 2:return L=g.XE(B),r="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",L instanceof g.G1&&L.type==="QUOTA_EXCEEDED"&&(r="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",l="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
B.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,r,l));case 3:return P=[],g.x(B,CFW(U.Y,"musicTrack",T),7);case 7:T=B.Y;if(T.length)for(V=g.J(T),v=V.next();!v.done;v=V.next())if(H=v.value,G=H.offlineVideoData,F=void 0,(F=G)==null?0:F.videoId)N=void 0,e=Number(((N=Y.actionMetadata)==null?void 0:N.priority)||0)+1,P.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",G.videoId,"musicTrack",e,KP,Xc(Y,G,d)));return B.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,P))}})},
mYO=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t,zV,Im,jL,Rm,vW,b8,hq,am,k,R,a,b,m,N4,A3,W3,dX,ac,KY,jz,NV,fa,n6,na,Dp,F1,$Z,ag,G$,xO,OR,m$,B7,T$,Ix;
return g.S(function(zd){switch(zd.T){case 1:return A=LP(Y),c=Y.entityKey,d=g.Uk(c).entityId,T=[],E=!1,d==="!*$_ALL_ENTITIES_!*$"?(E=!0,g.x(zd,q$(U.Y,"musicPlaylist"),5)):g.x(zd,Kt(U.Y,c,"musicPlaylist"),4);case 4:(L=zd.Y)&&T.push(L);zd.uY(3);break;case 5:T=zd.Y;case 3:if((r=T)==null||!r.length)return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));l=g.O(Y.actionMetadata,jMI);V=(P=l)==null?void 0:P.autoSync;v=[];G=H=!0;F=!1;N=void 0;if(!E&&V===!1){zd.uY(6);break}g.J3(zd,7);return g.x(zd,
xvz(0,!!V,!0,T),9);case 9:v=zd.Y;g.t3(zd,8);break;case 7:e=g.XE(zd);if(!(e instanceof Error&&e.message==="No data")){e instanceof Error&&e.message==="Empty response body"&&cQ(e.message);zd.uY(8);break}return d==="!*$_ALL_ENTITIES_!*$"?g.x(zd,BQ(U.Y,Y,U.W),8):g.x(zd,eZ(d,"musicPlaylist",U.Y,Y,U.W),8);case 8:if(!v.length||!E&&v[0].playlistId!==d)return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));case 6:if(E){B=[];f=g.J(v);for(h=f.next();!h.done;h=f.next())Q=h.value,Q.upToDate||
V&&!Q.shouldAutoSyncMetadata||!Q.playlistId||(K={autoSync:V},B.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",Q.playlistId,"musicPlaylist",0,KP,{musicPlaylistEntityActionMetadata:K})));return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,B))}v.length&&(D=v[0],F=!!D.upToDate,V&&(H=(c3=D.shouldAutoSyncMetadata)!=null?c3:!0,G=(TV=D.shouldAutoSyncVideos)!=null?TV:!0,D.checkInSeconds&&(N=D.checkInSeconds)));if(F||!H)return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A));U9=[];LY=T[0];q=void 0;if(!LY.downloadMetadata){zd.uY(15);break}return g.x(zd,Kt(U.Y,LY.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:FE=zd.Y,q=Number((O9=(B3=FE)==null?void 0:B3.addedTimestampMillis)!=null?O9:"0")/1E3;case 15:return g.J3(zd,17),g.x(zd,ZFj(U,d,(tq=q)==null?void 0:tq.toString(),N),19);case 19:U9=zd.Y;g.t3(zd,18);break;case 17:Lj=g.XE(zd);if(!(Lj instanceof Error&&Lj.message==="No data")){if(Lj instanceof Error&&Lj.message==="Empty response body")cQ(Lj.message);
else return kl="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",eS="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Lj instanceof g.G1&&Lj.type==="QUOTA_EXCEEDED"&&(kl="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",eS="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,kl,eS));zd.uY(18);break}return g.x(zd,eZ(d,"musicPlaylist",U.Y,Y,U.W),18);case 18:if(!G)return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A));To=[];t=new Map;if((zV=U9)==null?0:zV.length)for(Im=g.J(U9),jL=Im.next();!jL.done;jL=Im.next())Rm=jL.value,vW=Rm.offlineVideoData,b8=void 0,((b8=vW)==null?0:b8.videoId)&&t.set(vW.videoId,vW);hq=new Map;am=[];if((k=LY)==null?0:(R=k.tracks)==null?0:R.length)for(a=g.J(LY.tracks),b=a.next();!b.done;b=a.next())if(m=b.value,N4=g.Uk(m).entityId)t.has(N4)?(hq.set(N4,t.get(N4)),t.delete(N4)):am.push(N4);W3=Number(((A3=Y.actionMetadata)==null?void 0:A3.priority)||0)+1;dX=g.J(t.entries());for(ac=dX.next();!ac.done;ac=
dX.next())KY=ac.value,jz=g.J(KY),NV=jz.next().value,fa=jz.next().value,n6=NV,na=fa,To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",n6,"musicTrack",W3,KP,Xc(Y,na)));Dp=g.J(hq.entries());for(F1=Dp.next();!F1.done;F1=Dp.next())$Z=F1.value,ag=g.J($Z),G$=ag.next().value,xO=ag.next().value,OR=G$,m$=xO,To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",OR,"musicTrack",W3,KP,Xc(Y,m$)));B7=g.J(am);for(T$=B7.next();!T$.done;T$=B7.next())Ix=T$.value,To.push(xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
Ix,"musicTrack",0,KP));return zd.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,To))}})},g4Y=function(U,Y){var A,c;
return g.S(function(d){switch(d.T){case 1:return A=LP(Y),g.J3(d,2),c=g.Uk(Y.entityKey).entityId,c==="!*$_ALL_ENTITIES_!*$"?g.x(d,BQ(U.Y,Y,U.W),5):g.x(d,eZ(c,"musicPlaylist",U.Y,Y,U.W),6);case 6:return g.x(d,JZL(U.Y,Y.entityKey),5);case 5:g.t3(d,3);break;case 2:return g.XE(d),d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},ZFj=function(U,Y,A,c){var d,T,E;
return g.S(function(L){switch(L.T){case 1:return g.x(L,epW([Y]),2);case 2:return d=L.Y,g.x(L,yaY(U,d[0],A,c),3);case 3:return T=L.Y,E=HQ(T.thumbnailDetails),g.x(L,Js(E),4);case 4:return L.return(d[0].videos)}})},yaY=function(U,Y,A,c){var d,T,E,L,r,l,P,V,v;
return g.S(function(H){return H.T==1?(d=Y.playlistId,T=FIf(Y),E=T.dZ,L=T.OU,r=A?(Number(A)*1E3).toString():Date.now().toString(),l=Y.lastModifiedTimestamp?(Number(Y.lastModifiedTimestamp)*1E3).toString():"0",P={id:g.YX(d,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:L,lastModifiedTimestampMillis:l,addedTimestampMillis:r,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},V={id:g.YX(d,"musicPlaylist"),title:Y.title,playlistId:d,thumbnailDetails:Y.thumbnail,visibility:n4j(Y),trackCount:Y.totalVideoCount,
tracks:E,downloadMetadata:P.id},c&&(((v=V)==null?0:v.entityMetadata)?V.entityMetadata.nextAutoRefreshIntervalSeconds=String(c):V&&(V.entityMetadata={nextAutoRefreshIntervalSeconds:String(c)})),g.x(H,IA(U.Y,{mode:"readwrite",kt:!0},function(G){var F=g0(G,V,"musicPlaylist");G=g0(G,P,"musicPlaylistDownloadMetadataEntity");return g.NC.all([F,G])}),2)):H.return(V)})},n4j=function(U){switch(U.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},DYL=function(U,Y){this.Y=U;
this.W=Y},q3W=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G;
return g.S(function(F){switch(F.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,T=g.O(Y.actionMetadata,IQf),g.J3(F,2),g.x(F,uzw(U,d,void 0,(E=T)==null?void 0:E.track,(L=T)==null?void 0:L.albumRelease),4);case 4:if((r=T)==null?0:r.playlistId){F.uY(5);break}return g.x(F,iBT(U.Y,Y.entityKey),5);case 5:g.t3(F,3);break;case 2:return l=g.XE(F),P="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",V="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",l instanceof g.G1&&l.type==="QUOTA_EXCEEDED"&&
(P="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",V="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),F.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,P,V));case 3:H=Number(((v=Y.actionMetadata)==null?void 0:v.priority)||0)+1;var N=(N=g.O(Y.actionMetadata,IQf))?{playbackDataActionMetadata:{maximumDownloadQuality:N.maximumDownloadQuality}}:void 0;G=xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",d,"playbackData",H,KOW,N);return F.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A,[G]))}})},Cez=function(U,Y){var A,c,d,T,E,L,r,l,P,V,v,H,G,F,N;
return g.S(function(e){switch(e.T){case 1:return A=LP(Y),c=g.Uk(Y.entityKey),d=c.entityId,g.x(e,Kt(U.Y,Y.entityKey,"musicTrack"),2);case 2:T=e.Y;if(!T){E=void 0;e.uY(3);break}return g.x(e,Kt(U.Y,T.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:E=e.Y;case 3:L=E;if(!T||!L)return e.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A));l=g.O(Y.actionMetadata,IQf);g.J3(e,5);return g.x(e,uzw(U,d,L.addedTimestampMillis,(P=l)==null?void 0:P.track,(V=l)==null?void 0:V.albumRelease),
7);case 7:H=Number(((v=Y.actionMetadata)==null?void 0:v.priority)||0)+1;r=xd("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",d,"playbackData",H,KOW);g.t3(e,6);break;case 5:G=g.XE(e);if(!(G instanceof Error&&G.message==="No data")){if(G instanceof Error&&G.message==="Empty response body")cQ(G.message);else return F="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",N="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",G instanceof g.G1&&G.type==="QUOTA_EXCEEDED"&&(F="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
N="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),e.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,F,N));e.uY(6);break}return g.x(e,ts(d,U.Y,Y,U.W),6);case 6:return e.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",A,r?[r]:void 0))}})},ULz=function(U,Y){var A,c;
return g.S(function(d){switch(d.T){case 1:return A=LP(Y),g.J3(d,2),c=g.Uk(Y.entityKey).entityId,c==="!*$_ALL_ENTITIES_!*$"?g.x(d,BQ(U.Y,Y,U.W),5):g.x(d,ts(c,U.Y,Y,U.W),6);case 6:return g.x(d,JZL(U.Y,Y.entityKey),5);case 5:g.t3(d,3);break;case 2:return g.XE(d),d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",A,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return d.return(new sm("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
A))}})},uzw=function(U,Y,A,c,d){var T,E,L,r,l,P;
return g.S(function(V){switch(V.T){case 1:if(T=c){V.uY(2);break}return g.x(V,tkf([Y]),3);case 3:E=V.Y,L=E[0],T=wPf(L);case 2:return g.x(V,Yso(U,T,Y,d,A),4);case 4:r=V.Y;l=r.musicTrackEntity;P=r.Mi;var v=HQ(l.thumbnailDetails),H=[];P&&(H=HQ(P.thumbnailDetails));return g.x(V,Js(v.concat(H)),0)}})},Yso=function(U,Y,A,c,d){var T;
return g.S(function(E){return E.T==1?(d||(d=Date.now().toString()),T={id:g.YX(A,"musicTrackDownloadMetadataEntity"),playbackData:g.YX(A,"playbackData"),addedTimestampMillis:d,videoDownloadContextEntity:g.YX(A,"videoDownloadContextEntity")},c&&(Y.albumRelease=c.id),g.x(E,IA(U.Y,{mode:"readwrite",kt:!0},function(L){var r=[],l=g0(L,T,"musicTrackDownloadMetadataEntity");r.push(l);l=g0(L,Y,"musicTrack");r.push(l);c&&(L=g0(L,c,"musicAlbumRelease"),r.push(L));return g.NC.all(r)}),2)):E.T!=3?g.x(E,Vs(A,"musicTrackDownloadMetadataEntity",
U.Y,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):E.return({musicTrackEntity:Y,
Mi:c})})},qu=function(){ys.apply(this,arguments);
this.X="musicTrack"},AfT=function(U,Y,A){Y=Y===void 0?43200:Y;
A=A===void 0?!0:A;var c=c===void 0?!1:c;var d,T;return g.S(function(E){switch(E.T){case 1:if(!U.J.gY())return E.return([]);d=[];g.J3(E,2);return g.x(E,xvz(Y,A,c),4);case 4:d=E.Y;g.t3(E,3);break;case 2:g.XE(E);case 3:return T=zew(U,d,A,"musicPlaylist"),E.return(T)}})},cfm=function(){g.lj.apply(this,arguments);
var U=this;this.events=new g.Qy(this);this.MI=this.player.L();this.o5={hsv:function(){return U.Y},
J5:function(){return U.J5()},
Bs:function(Y){return U.Bs(Y)}}},dLq=function(U){var Y;
U=g.O((Y=U.getWatchNextResponse())==null?void 0:Y.currentVideoEndpoint,g.Yp);if(U==null?0:U.playlistId)var A=U.playlistId;return A},TFL=function(U,Y){var A,c,d,T;
return g.S(function(E){if(E.T==1){A=Y.clientPlaybackNonce;c={cpn:A,offlineSourceVisualElement:g.tz(Y.Zf||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};Y.T&&(c.videoFmt=Number(Y.T.itag));Y.j&&(c.audioFmt=Number(Y.j.itag));if((d=dLq(Y))&&Y.videoId){var L=Y.videoId;L=d!=="PPSV"?Promise.resolve(!1):U.Y.Bz(L);E=g.x(E,L,3)}else E=E.uY(2);return E}E.T!=2&&(T=E.Y)&&(c.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");U.T=A;g.r7("offlinePlaybackStarted",c);g.i8(E)})};
g.XT.prototype.qD=g.E9(51,function(U){return this.app.qD(U)});
g.vv.prototype.qD=g.E9(50,function(U){return g.F_S(this,9,U)});
g.w(Sq,hN);g.oc.Object.defineProperties(Sq.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.Y.entityMetadata},
set:function(U){this.Y.entityMetadata=U}}});
g.w(K$Y,Sq);K$Y.prototype.T=function(){return[]};
g.w(qRL,Sq);qRL.prototype.T=function(){return[]};
g.w(Caz,Sq);Caz.prototype.T=function(){return[]};
g.w(UUo,Sq);UUo.prototype.T=function(){return[]};
g.w(YTz,Sq);YTz.prototype.T=function(){var U=[];this.Y.alternateChannel&&U.push(this.Y.alternateChannel);this.Y.alternateChannelList&&U.push.apply(U,g.X(this.Y.alternateChannelList));this.Y.oneofChannelEntity&&U.push(this.Y.oneofChannelEntity);return[].concat(g.X(new Set(U)))};
g.w(AYw,Sq);AYw.prototype.T=function(){var U=[];this.Y.entryCollection&&U.push(this.Y.entryCollection);return[].concat(g.X(new Set(U)))};
g.w(cYF,hN);cYF.prototype.T=function(){var U=[];this.Y.video&&U.push(this.Y.video);return[].concat(g.X(new Set(U)))};
g.w(dUL,Sq);dUL.prototype.T=function(){var U=[];this.Y.parentPlaylist&&U.push(this.Y.parentPlaylist);if(this.Y.entries)for(var Y=g.J(this.Y.entries),A=Y.next();!A.done;A=Y.next())U.push.apply(U,g.X((new cYF(A.value)).T()));return[].concat(g.X(new Set(U)))};
g.w(Tcq,Sq);Tcq.prototype.T=function(){var U=[];this.Y.descriptionEntity&&U.push(this.Y.descriptionEntity);this.Y.creators&&U.push.apply(U,g.X(this.Y.creators));this.Y.theBiggestFan&&U.push(this.Y.theBiggestFan);return[].concat(g.X(new Set(U)))};
g.w(E3j,Sq);E3j.prototype.T=function(){return[]};
g.w(o3o,Sq);o3o.prototype.T=function(){return[]};
g.w(zTY,Sq);zTY.prototype.T=function(){return[]};
g.w(Luf,Sq);Luf.prototype.T=function(){return[]};
g.w(rYL,Sq);rYL.prototype.T=function(){return[]};
g.w(ldo,Sq);ldo.prototype.T=function(){return[]};
g.w(PYz,Sq);PYz.prototype.T=function(){return[]};
g.w(Vyz,Sq);Vyz.prototype.T=function(){return[]};
g.w($Uo,Sq);$Uo.prototype.T=function(){return[]};
g.w(v3q,Sq);v3q.prototype.T=function(){var U=[];this.Y.downloadsList&&U.push(this.Y.downloadsList);this.Y.smartDownloadsList&&U.push(this.Y.smartDownloadsList);this.Y.recommendedDownloadsList&&U.push(this.Y.recommendedDownloadsList);this.Y.refresh&&U.push(this.Y.refresh);return[].concat(g.X(new Set(U)))};
g.w(HLO,hN);HLO.prototype.T=function(){var U=[];this.Y.video&&U.push(this.Y.video);this.Y.playlist&&U.push(this.Y.playlist);this.Y.videoItem&&U.push(this.Y.videoItem);this.Y.playlistItem&&U.push(this.Y.playlistItem);return[].concat(g.X(new Set(U)))};
g.w(GtF,Sq);GtF.prototype.T=function(){var U=[];this.Y.refresh&&U.push(this.Y.refresh);if(this.Y.downloads)for(var Y=g.J(this.Y.downloads),A=Y.next();!A.done;A=Y.next())U.push.apply(U,g.X((new HLO(A.value)).T()));return[].concat(g.X(new Set(U)))};
g.w(WuW,Sq);WuW.prototype.T=function(){var U=[];this.Y.localImageEntities&&U.push.apply(U,g.X(this.Y.localImageEntities));return[].concat(g.X(new Set(U)))};
g.w(wrT,Sq);wrT.prototype.T=function(){var U=[];this.Y.playbackData&&U.push(this.Y.playbackData);this.Y.localImageEntities&&U.push.apply(U,g.X(this.Y.localImageEntities));this.Y.videoDownloadContextEntity&&U.push(this.Y.videoDownloadContextEntity);return[].concat(g.X(new Set(U)))};
g.w(iLw,Sq);iLw.prototype.T=function(){return[]};
g.w(JYo,Sq);JYo.prototype.T=function(){var U=[];this.Y.fakeChildren&&U.push.apply(U,g.X(this.Y.fakeChildren));return[].concat(g.X(new Set(U)))};
g.w(Fuo,Sq);Fuo.prototype.T=function(){var U=[];this.Y.video&&U.push(this.Y.video);this.Y.playbackData&&U.push(this.Y.playbackData);this.Y.offlineVideoPolicy&&U.push(this.Y.offlineVideoPolicy);return[].concat(g.X(new Set(U)))};
g.w(jDz,Sq);jDz.prototype.T=function(){return[]};
g.w(Nco,Sq);Nco.prototype.T=function(){var U=[];this.Y.channelOwner&&U.push(this.Y.channelOwner);this.Y.videos&&U.push.apply(U,g.X(this.Y.videos));this.Y.collaboratorChannels&&U.push.apply(U,g.X(this.Y.collaboratorChannels));this.Y.downloadState&&U.push(this.Y.downloadState);this.Y.refresh&&U.push(this.Y.refresh);return[].concat(g.X(new Set(U)))};
g.w(tyz,Sq);tyz.prototype.T=function(){var U=[];this.Y.video&&U.push(this.Y.video);this.Y.channelContributor&&U.push(this.Y.channelContributor);return[].concat(g.X(new Set(U)))};
g.w(eTI,hN);eTI.prototype.T=function(){var U=[];this.Y.localImageEntities&&U.push.apply(U,g.X(this.Y.localImageEntities));this.Y.videoDownloadContextEntity&&U.push(this.Y.videoDownloadContextEntity);return[].concat(g.X(new Set(U)))};
g.w(Bcf,hN);Bcf.prototype.T=function(){var U=[];this.Y.recommendedVideoMetadata&&U.push.apply(U,g.X((new eTI(this.Y.recommendedVideoMetadata)).T()));return[].concat(g.X(new Set(U)))};
g.w(Xrm,hN);Xrm.prototype.T=function(){var U=[];this.Y.playbackPosition&&U.push(this.Y.playbackPosition);return[].concat(g.X(new Set(U)))};
g.w(ktz,Sq);ktz.prototype.T=function(){var U=[];this.Y.owner&&U.push(this.Y.owner);this.Y.downloadState&&U.push(this.Y.downloadState);this.Y.userState&&U.push.apply(U,g.X((new Xrm(this.Y.userState)).T()));this.Y.additionalMetadata&&U.push.apply(U,g.X((new Bcf(this.Y.additionalMetadata)).T()));return[].concat(g.X(new Set(U)))};
g.w(RTI,Sq);RTI.prototype.T=function(){var U=[];this.Y.userChannelDetails&&U.push(this.Y.userChannelDetails);return[].concat(g.X(new Set(U)))};
g.w(adf,Sq);adf.prototype.T=function(){var U=[];this.Y.channelOwner&&U.push(this.Y.channelOwner);this.Y.playbackPosition&&U.push(this.Y.playbackPosition);this.Y.localImageEntities&&U.push.apply(U,g.X(this.Y.localImageEntities));this.Y.downloadStatus&&U.push(this.Y.downloadStatus);return[].concat(g.X(new Set(U)))};
g.w(xUY,Sq);xUY.prototype.T=function(){return[]};
g.w(sDq,Sq);sDq.prototype.T=function(){return[]};
g.w(fdo,Sq);fdo.prototype.T=function(){return[]};
g.w(hTT,Sq);hTT.prototype.T=function(){return[]};
g.w(STL,Sq);STL.prototype.T=function(){return[]};
g.w(Myw,Sq);Myw.prototype.T=function(){return[]};
g.w(bLT,Sq);bLT.prototype.T=function(){return[]};
g.w(prz,Sq);prz.prototype.T=function(){return[]};
g.w(QDT,Sq);QDT.prototype.T=function(){return[]};
g.w(ZLL,Sq);ZLL.prototype.T=function(){return[]};
g.w(OLj,Sq);OLj.prototype.T=function(){return[]};
g.w(mUO,Sq);mUO.prototype.T=function(){var U=[];this.Y.trackDownloadMetadatas&&U.push.apply(U,g.X(this.Y.trackDownloadMetadatas));return[].concat(g.X(new Set(U)))};
g.w(g3z,Sq);
g3z.prototype.T=function(){var U=[];this.Y.downloadedTracks&&U.push.apply(U,g.X(this.Y.downloadedTracks));this.Y.smartDownloadedTracks&&U.push.apply(U,g.X(this.Y.smartDownloadedTracks));this.Y.downloadedEpisodes&&U.push.apply(U,g.X(this.Y.downloadedEpisodes));this.Y.downloadedAlbumReleases&&U.push.apply(U,g.X(this.Y.downloadedAlbumReleases));this.Y.smartDownloadedAlbumReleases&&U.push.apply(U,g.X(this.Y.smartDownloadedAlbumReleases));this.Y.downloadedPlaylists&&U.push.apply(U,g.X(this.Y.downloadedPlaylists));this.Y.smartDownloadedPlaylists&&
U.push.apply(U,g.X(this.Y.smartDownloadedPlaylists));this.Y.metadataOnlyTracks&&U.push.apply(U,g.X(this.Y.metadataOnlyTracks));return[].concat(g.X(new Set(U)))};
g.w(yYf,Sq);yYf.prototype.T=function(){var U=[];this.Y.trackDownloadMetadatas&&U.push.apply(U,g.X(this.Y.trackDownloadMetadatas));return[].concat(g.X(new Set(U)))};
g.w(n3z,Sq);n3z.prototype.T=function(){var U=[];this.Y.playbackData&&U.push(this.Y.playbackData);this.Y.localImageEntities&&U.push.apply(U,g.X(this.Y.localImageEntities));this.Y.videoDownloadContextEntity&&U.push(this.Y.videoDownloadContextEntity);return[].concat(g.X(new Set(U)))};
g.w(DUq,Sq);DUq.prototype.T=function(){var U=[];this.Y.musicLibraryStatusEntity&&U.push(this.Y.musicLibraryStatusEntity);this.Y.primaryArtists&&U.push.apply(U,g.X(this.Y.primaryArtists));this.Y.details&&U.push(this.Y.details);this.Y.userDetails&&U.push(this.Y.userDetails);this.Y.tracks&&U.push.apply(U,g.X(this.Y.tracks));this.Y.share&&U.push(this.Y.share);this.Y.downloadMetadata&&U.push(this.Y.downloadMetadata);this.Y.refresh&&U.push(this.Y.refresh);return[].concat(g.X(new Set(U)))};
g.w(Idz,Sq);Idz.prototype.T=function(){var U=[];this.Y.albumRelease&&U.push(this.Y.albumRelease);this.Y.tracks&&U.push.apply(U,g.X(this.Y.tracks));return[].concat(g.X(new Set(U)))};
g.w(uMW,Sq);uMW.prototype.T=function(){var U=[];this.Y.albumRelease&&U.push(this.Y.albumRelease);return[].concat(g.X(new Set(U)))};
g.w(KuY,Sq);KuY.prototype.T=function(){var U=[];this.Y.details&&U.push(this.Y.details);this.Y.userDetails&&U.push(this.Y.userDetails);return[].concat(g.X(new Set(U)))};
g.w(qTT,Sq);qTT.prototype.T=function(){var U=[];this.Y.parentArtist&&U.push(this.Y.parentArtist);return[].concat(g.X(new Set(U)))};
g.w(CYq,Sq);CYq.prototype.T=function(){var U=[];this.Y.parentArtist&&U.push(this.Y.parentArtist);return[].concat(g.X(new Set(U)))};
g.w(U3j,Sq);U3j.prototype.T=function(){return[]};
g.w(YgY,Sq);YgY.prototype.T=function(){return[]};
g.w(ASw,hN);ASw.prototype.T=function(){var U=[];this.Y.creatorEntity&&U.push(this.Y.creatorEntity);return[].concat(g.X(new Set(U)))};
g.w(cSz,Sq);
cSz.prototype.T=function(){var U=[];this.Y.tracks&&U.push.apply(U,g.X(this.Y.tracks));this.Y.refresh&&U.push(this.Y.refresh);this.Y.musicLibraryStatusEntity&&U.push(this.Y.musicLibraryStatusEntity);this.Y.details&&U.push(this.Y.details);this.Y.downloadMetadata&&U.push(this.Y.downloadMetadata);this.Y.sideloadMetadata&&U.push(this.Y.sideloadMetadata);this.Y.userDetails&&U.push(this.Y.userDetails);this.Y.entryCollection&&U.push(this.Y.entryCollection);this.Y.share&&U.push(this.Y.share);this.Y.podcastShowAdditionalMetadata&&U.push.apply(U,
g.X((new ASw(this.Y.podcastShowAdditionalMetadata)).T()));return[].concat(g.X(new Set(U)))};
g.w(d3Y,Sq);d3Y.prototype.T=function(){return[]};
g.w(T9O,Sq);
T9O.prototype.T=function(){var U=[];this.Y.musicLibraryStatusEntity&&U.push(this.Y.musicLibraryStatusEntity);this.Y.artists&&U.push.apply(U,g.X(this.Y.artists));this.Y.audioModeVersion&&U.push(this.Y.audioModeVersion);this.Y.videoModeVersion&&U.push(this.Y.videoModeVersion);this.Y.userDetails&&U.push(this.Y.userDetails);this.Y.details&&U.push(this.Y.details);this.Y.albumRelease&&U.push(this.Y.albumRelease);this.Y.share&&U.push(this.Y.share);this.Y.libraryEdit&&U.push(this.Y.libraryEdit);this.Y.downloadMetadata&&
U.push(this.Y.downloadMetadata);this.Y.playbackPosition&&U.push(this.Y.playbackPosition);this.Y.lyrics&&U.push(this.Y.lyrics);return[].concat(g.X(new Set(U)))};
g.w(EMo,Sq);EMo.prototype.T=function(){var U=[];this.Y.parentTrack&&U.push(this.Y.parentTrack);return[].concat(g.X(new Set(U)))};
g.w(oMI,Sq);oMI.prototype.T=function(){var U=[];this.Y.parentTrack&&U.push(this.Y.parentTrack);return[].concat(g.X(new Set(U)))};
g.w(zGW,Sq);zGW.prototype.T=function(){return[]};
g.w(LGf,Sq);LGf.prototype.T=function(){return[]};
g.w(rSI,Sq);rSI.prototype.T=function(){return[]};
g.w(lmz,Sq);lmz.prototype.T=function(){return[]};
g.w(P7O,Sq);P7O.prototype.T=function(){var U=[];this.Y.transfer&&U.push(this.Y.transfer);this.Y.adsPlaybackData&&U.push.apply(U,g.X(this.Y.adsPlaybackData));this.Y.drmLicense&&U.push(this.Y.drmLicense);this.Y.offlineVideoPolicy&&U.push(this.Y.offlineVideoPolicy);this.Y.videoDownloadContextEntity&&U.push(this.Y.videoDownloadContextEntity);return[].concat(g.X(new Set(U)))};
g.w(VWw,Sq);VWw.prototype.T=function(){return[]};
g.w($3w,Sq);$3w.prototype.T=function(){var U=[];this.Y.offlineVideoStreams&&U.push.apply(U,g.X(this.Y.offlineVideoStreams));this.Y.captionTrack&&U.push.apply(U,g.X(this.Y.captionTrack));return[].concat(g.X(new Set(U)))};
g.w(vMT,Sq);vMT.prototype.T=function(){return[]};
g.w(Hez,Sq);Hez.prototype.T=function(){return[]};
g.w(Gcm,Sq);Gcm.prototype.T=function(){return[]};
g.w(WGq,Sq);WGq.prototype.T=function(){return[]};
g.w(wOW,Sq);wOW.prototype.T=function(){return[]};
g.w(ieF,Sq);ieF.prototype.T=function(){return[]};
g.w(JSL,Sq);JSL.prototype.T=function(){return[]};
g.w(FGw,Sq);FGw.prototype.T=function(){return[]};
g.w(jzW,Sq);jzW.prototype.T=function(){return[]};
g.w(N9m,Sq);N9m.prototype.T=function(){return[]};
g.w(tWO,Sq);tWO.prototype.T=function(){return[]};
g.w(eGw,Sq);eGw.prototype.T=function(){return[]};
g.w(B9o,Sq);B9o.prototype.T=function(){return[]};
g.w(XOo,Sq);XOo.prototype.T=function(){return[]};
g.w(kcI,Sq);kcI.prototype.T=function(){return[]};
g.w(RGz,Sq);RGz.prototype.T=function(){return[]};
g.w(amL,Sq);amL.prototype.T=function(){return[]};
g.w(x3o,Sq);x3o.prototype.T=function(){return[]};
g.w(szT,Sq);szT.prototype.T=function(){return[]};
g.w(fmw,Sq);fmw.prototype.T=function(){return[]};
var sMz=["browse","music/browse","unplugged/browse"],bBw=["offline/playlist_sync_check"],Nqm=["offline"],fGT=["offline/offline_video_playback_position_sync"],SAf=["offline/get_playback_data_entity"],M$;b_.getInstance=function(){return g.S(function(U){return U.return(new Promise(function(Y){g.Cg().then(function(A){A?(b_.instance||(b_.instance=new b_(A)),Y(b_.instance)):Y(void 0)})}))})};
b_.prototype.get=function(U){var Y=this,A,c,d;return g.S(function(T){if(T.T==1)return g.x(T,beL(Y.token),2);if(T.T!=3)return A=T.Y,g.x(T,A.get("prefs",U),3);c=T.Y;if(!c)return T.return();d=(0,g.y)();return c.expirationTimestampMs<=d?T.return():T.return(c.value)})};
b_.prototype.set=function(U,Y,A){A=A===void 0?31536E3:A;var c=this,d,T,E;return g.S(function(L){if(L.T==1)return d=(0,g.y)(),T={key:U,value:Y,expirationTimestampMs:d+A*1E3},g.x(L,beL(c.token),2);E=L.Y;return g.x(L,g.fg(E,"prefs",T),0)})};
b_.prototype.remove=function(U){var Y=this,A;return g.S(function(c){if(c.T==1)return g.x(c,beL(Y.token),2);A=c.Y;return g.x(c,A.delete("prefs",U),0)})};
g.w(pt,g.Do);g.w(Q3,m3O);Q3.prototype.W=function(U,Y){Y=ySI(Y);U=(new TextEncoder).encode(JSON.stringify(U));return this.Y.encrypt(U,Y)};
Q3.prototype.T=function(U,Y){if(!(U instanceof Uint8Array))throw pOF(1);var A=new TextDecoder;Y=ySI(Y);U=this.Y.decrypt(U,Y);return JSON.parse(A.decode(U))};
var nMO={accountLinkStatusEntity:zTY,booleanEntity:Caz,buttonEntity:B9o,captionTrack:zGW,channelHandle:K$Y,commerceAcquisitionClientPayloadEntity:kcI,commerceCartListEntity:RGz,contextNoteFeedEntityPayload:qRL,continuationTokenEntity:jDz,downloadQualityPickerEntity:PYz,downloadsPageRefreshTokenEntity:$Uo,downloadsPageViewConfigurationEntity:xUY,downloadStatusEntity:Vyz,dismissState:JSL,sfvAudioItemCurrentlyPlayingEntity:WGq,emojiFountainDataEntity:tWO,emojiCustomizationSetEntity:N9m,fakeChannel:YTz,
fakePlaylist:AYw,fakePlaylistEntryCollection:dUL,fakeVideo:Tcq,fakeVideoDescription:E3j,featuredProductsEntity:QDT,flowStateEntity:o3o,iconBadgeEntity:amL,interstitialInteractionStateEntity:rYL,likeButtonAnimationEntity:sDq,liveChatPollStateEntity:ldo,liveViewerLeaderboardChatEntryPointStateEntity:Hez,liveViewerLeaderboardPointsEntity:Gcm,liveReactionsDataEntity:eGw,logoEntity:Luf,macroMarkerEntity:fdo,mainDownloadsLibraryEntity:v3q,mainDownloadsListEntity:GtF,mainPlaylistDownloadStateEntity:WuW,
mainPlaylistEntity:Nco,mainPlaylistVideoEntity:tyz,mainVideoDownloadStateEntity:wrT,mainVideoEntity:ktz,markersEngagementPanelSyncEntity:hTT,markersVisibilityOverrideEntity:STL,musicAlbumReleaseDetail:Idz,musicAlbumReleaseDownloadMetadataEntity:mUO,musicAlbumRelease:DUq,musicAlbumReleaseUserDetail:uMW,musicArtistDetail:qTT,musicArtist:KuY,musicArtistUserDetail:CYq,musicDownloadsLibraryEntity:g3z,musicLibraryEdit:U3j,musicLibraryStatusEntity:YgY,musicPlaylist:cSz,musicPlaylistDownloadMetadataEntity:yYf,
musicShare:d3Y,musicTrackDetail:EMo,musicTrackDownloadMetadataEntity:n3z,musicTrack:T9O,musicTrackUserDetail:oMI,offlineOrchestrationActionWrapperEntity:LGf,offlineVideoPolicy:rSI,offlineVideoStreams:lmz,offlineabilityEntity:iLw,orchestrationWebSamplingEntity:JYo,pageHeaderEntity:FGw,pdpStateEntity:x3o,pinnedProductEntity:ZLL,playbackData:P7O,playerStateEntity:Myw,quantityIncrementerEntity:szT,refresh:VWw,saveToPlaylistListEntity:wOW,settingEntity:ieF,stringEntity:UUo,suggestedFeedbackChipStateEntity:bLT,
transfer:$3w,trendingOfferEntity:OLj,videoDownloadContextEntity:vMT,videoOverviewAsyncDataEntity:fmw,videoPlaybackPositionEntity:XOo,votingEntity:jzW,ytMainChannelEntity:RTI,youchatPendingResponseEntity:prz,ytMainDownloadedVideoEntity:Fuo,ytMainVideoEntity:adf};g.w(nt,m3O);nt.prototype.W=function(U){return U};
nt.prototype.T=function(U){if(U instanceof Uint8Array)throw pOF(0);return U};
g.w(Dv,g.p);Dv.prototype.observe=function(U){var Y=this;this.observers.push(U);return function(){var A=Y.observers.indexOf(U);A>=0&&Y.observers.splice(A,1)}};
Dv.prototype.T=function(U){oUY(this,U.data)};
Dv.prototype.Tn=function(){this.channel.close()};
var PFI,rZI=new g.eT("elementsCommand");var jZ=new g.eT("entityBatchUpdate");var qvm=new g.eT("downloadStatusEntity");var $YY=new g.eT("mainPlaylistEntityActionMetadata");var II=new g.eT("mainVideoEntityActionMetadata");var jMI=new g.eT("musicPlaylistEntityActionMetadata");var IQf=new g.eT("musicTrackEntityActionMetadata");var kjo=new g.eT("localImageEntityActionMetadata");var fP=new g.eT("playbackDataActionMetadata");var lUL=new g.eT("transferEntityActionMetadata");var u0j=new g.eT("videoPlaybackPositionEntityActionMetadata");var Bpj;new g.VI;new g.VI;x7j.prototype.request=function(U,Y,A){Y=Y===void 0?{}:Y;return this.locks.request(U,Y,function(c){return A(c)})};var As=g.Dc.caches,Yd,MJF;Um.prototype.open=function(U){return As.open(hNj(U))};
Um.prototype.has=function(U){return As.has(hNj(U))};
Um.prototype.delete=function(U){return As.delete(hNj(U))};
Um.prototype.match=function(U,Y){var A=this,c,d,T,E,L,r;return g.S(function(l){switch(l.T){case 1:return g.x(l,A.keys(),2);case 2:c=l.Y,d=g.J(c),T=d.next();case 3:if(T.done){l.uY(5);break}E=T.value;return g.x(l,A.open(E),6);case 6:return L=l.Y,g.x(l,L.match(U,Y),7);case 7:if(r=l.Y)return l.return(r);T=d.next();l.uY(3);break;case 5:return l.return()}})};
g.w(f_w,Um);f_w.prototype.keys=function(){var U,Y,A,c,d,T,E,L,r;return g.S(function(l){if(l.T==1)return U=[],Y=g.Ib("CacheStorage keys"),g.x(l,As.keys(),2);A=l.Y;c=g.J(A);for(d=c.next();!d.done;d=c.next()){T=d.value;var P=T.indexOf(":");E=P===-1?{W6:T}:{W6:T.substring(0,P),datasyncId:T.substring(P+1)};L=E.W6;r=E.datasyncId;r===Y&&U.push(L)}return l.return(U)})};g.w(di,g.p);di.prototype.W=function(U){this.api.Ev("onOfflineOperationFailure",U.data)};
di.prototype.j=function(U){this.api.publish("offlinetransferpause",U.data)};
di.prototype.Tn=function(){var U;(U=this.Y)==null||U.close();var Y;(Y=this.T)==null||Y.close()};Q_f.prototype.Wa=function(){this.Y&&Em(this)};
Q_f.prototype.le=function(){this.T&&this.T.resolve();this.W=this.Y=!1;this.X()};var BKm=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var oCz="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var WIo="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.w(QMz,aI);QMz.prototype.T=function(U){return ri(U)?mvY(this,U):l5(U)?nCO(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};g.w(Dvq,aI);Dvq.prototype.T=function(U){return l5(U)?IGO(this,U):K3z(U)?KIf(this,U):PQ(U)?qAj(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};g.W=CQm.prototype;g.W.wQW=function(U){var Y=this,A,c,d,T;return g.S(function(E){if(!g.I(U.state,128))return E.uY(0);A=U.state.Pb;var L=(c=A)==null?void 0:c.errorCode,r=(d=A)==null?void 0:d.oH;T=L==="net.connect"&&r===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(L==null?0:L.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.x(E,Y.vI(Y.player.getVideoData().videoId,T),0)})};
g.W.vI=function(U,Y){var A=this;return g.S(function(c){if(c.T==1){if(A.T)return c.return();A.T=!0;return Y==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(Mu(A,U,!1,!0),c.uY(0)):g.x(c,SZ(A,U),3)}g.sJ(U,4);return g.x(c,A.Y.vI(Y),0)})};
g.W.RQ=function(U){U.status===2?(U.status!==this.W&&(IUO(this.Y),g.sJ(U.videoId,2)),U.rj&&UYI(this.Y,U.videoId,U.rj)):U.status===4?(SZ(this,U.videoId),this.vI(U.videoId,U.y_?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):U.status===1&&Cgj(this.Y);this.W=U.status;this.api.Ev("localmediachange",{videoId:U.videoId,status:U.status})};
g.W.Ka=function(){var U=this,Y;return g.S(function(A){if(A.T==1){if(U.T)return A.return();U.T=!0;Y=U.player.getVideoData().videoId;return g.x(A,SZ(U,Y),2)}return g.x(A,U.Y.Ka(),0)})};
g.W.X0=function(U){switch(U){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.W.S=function(U){return this.api.L().S(U)};g.w(Eco,aI);Eco.prototype.T=function(U){return ri(U)?zfq(this,U):l5(U)?LDW(this,U):K3z(U)?rTY(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};HZI.prototype.Y=function(U,Y){var A=U.action.actionMetadata.priority-Y.action.actionMetadata.priority;A===0&&(U.Y<Y.Y?A=-1:U.Y>Y.Y&&(A=1));return A};g.w(b5,g.p);b5.prototype.Tn=function(){this.X&&this.X();g.p.prototype.Tn.call(this)};
b5.prototype.createAction=function(U,Y){var A=g.Uk(U.entityKey).entityType,c=g.tH(16);return new Gn(A,c,U,Y.actionId,Y.rootActionId)};
b5.prototype.Hw=function(U){var Y=this,A,c,d,T,E,L,r,l,P;return g.S(function(V){if(V.T==1){if(Y.Ky())return V.return();c=(A=U.offlineOrchestrationActionWrapperEntity)!=null?A:new Set;d=[];T=g.J(c);for(E=T.next();!E.done;E=T.next())L=E.value,r=g.Uk(L),l=r.entityId,wFW(Y.Y,l)||d.push(L);return g.x(V,Rfm(Y,d),2)}P=V.Y;return g.x(V,kxI(Y,P),0)})};
b5.prototype.retry=function(){var U=this;return g.S(function(Y){return g.x(Y,aUo(U),0)})};sum.prototype.CF=function(U,Y){Y=Y===void 0?!0:Y;var A=this,c,d,T,E,L,r,l,P;return g.S(function(V){switch(V.T){case 1:if(!A.Y)return V.return();c=[];d=g.qf(A.Y.T,Y);T=[];for(E={qx:0};E.qx<d.length;E={qx:E.qx},E.qx++)L=d[E.qx],r=A.Y.TR(L,"json3"),l=g.kG(r,{withCredentials:!0,format:"RAW"},3,500).then(function(v){return function(H){H={metadata:g.Wb(d[v.qx]),trackData:H.xhr.responseText};T.push(H)}}(E)).TX(function(v){cQ("Caption fetch error",v)}),c.push(l);
return g.x(V,u$L(c),2);case 2:return g.J3(V,3),g.x(V,i_o(U,T),5);case 5:g.t3(V,0);break;case 3:P=g.XE(V),cQ("Caption DB transaction error",P),g.i8(V)}})};g.w(pP,g.p);pP.prototype.Tn=function(){this.T&&this.T();g.p.prototype.Tn.call(this)};
pP.prototype.W=function(U){var Y=this,A,c,d,T,E,L,r,l;return g.S(function(P){c=(A=U.transfer)!=null?A:new Set;d=[];T=g.J(c);for(E=T.next();!E.done;E=T.next())L=E.value,r=g.Uk(L),l=r.entityId,d.push(l);return d.length===0?P.return():g.x(P,S4m(Y,d),0)})};g.w(ZZL,g.p);g.W=ZZL.prototype;g.W.Tn=function(){this.ov&&this.ov();this.jX.dispose();this.j.dispose();this.Uv&&g.YM(this.J.mF,this.Uv);this.eX&&g.YM(this.J.mF,this.eX);g.p.prototype.Tn.call(this)};
g.W.yes=function(U){var Y=this,A,c,d;return g.S(function(T){switch(T.T){case 1:A=g.YX(U,"transfer");if(Y.Y&&A===Y.Y.key){Mu(Y.G,Y.K,!0);Y.j.stop();T.uY(0);break}return g.x(T,IA(Y.T,{mode:"readwrite",kt:!0},function(E){return Zv(E,A,"transfer").then(function(L){if(L&&L.transferState!=="TRANSFER_STATE_COMPLETE"&&L.transferState!=="TRANSFER_STATE_FAILED")return L.transferState="TRANSFER_STATE_PAUSED_BY_USER",g0(E,L,"transfer").then(function(){return L})})}),3);
case 3:c=T.Y;if(!c){T.uY(0);break}if(!U||!Y.W){T.uY(5);break}return g.x(T,Vs(U,Y.W,Y.T,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.x(T,Om(Y,U),7);case 7:d=T.Y,I_O({videoId:U,sR:c,offlineModeType:d}),g.i8(T)}})};
g.W.GsX=function(){var U=this;if(this.Y&&this.K){Mu(this.G,this.K,!1);var Y=this.Y,A=(Y==null?0:Y.key)?g.Uk(Y.key).entityId:"";A&&this.W&&(new Promise(function(c,d){Vs(A,U.W,U.T,"DOWNLOAD_STATE_PAUSED").catch(function(T){d(T)})})).catch(function(c){cQ("Download state setting error",c)})}this.j.stop()};
g.W.nj=function(){this.Y?gcj(this,this.Y):Z9(this)};
g.W.y7=function(U){var Y=this;return g.S(function(A){switch(A.T){case 1:if(!Y.Y){A.uY(2);break}if(Y.Y.transferState==="TRANSFER_STATE_COMPLETE"||Y.Y.transferState==="TRANSFER_STATE_FAILED"||!U.transfer||!U.transfer.has(Y.Y.key)){A.uY(3);break}return g.x(A,Kt(Y.T,Y.Y.key,"transfer"),4);case 4:Y.Y=A.Y;if(Y.Y){A.uY(3);break}return g.x(A,yTz(Y),3);case 3:if(Y.Y)return A.return();case 2:return g.x(A,Z9(Y),0)}})};
g.W.vI=function(U,Y){var A=this,c,d,T,E,L;return g.S(function(r){switch(r.T){case 1:if(!A.Y){mh(A,"onTransferFailure: "+U);r.uY(2);break}c=A.Y;T=((d=c)==null?0:d.key)?g.Uk(c.key).entityId:"";a:switch(U){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var l=!1;break a;default:l=!0}return l&&Y3m(A)?g.x(r,gi(A,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.x(r,
Aaz(A,U),5);case 5:if(!T||!A.W){r.uY(2);break}return g.x(r,Vs(T,A.W,A.T,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.x(r,Om(A,T),9);case 9:E=r.Y;zn({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:T,sR:c,offlineModeType:E});if(!T||!A.W){r.uY(2);break}return g.x(r,Vs(T,A.W,A.T,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:Qs(A),L=Z9(A,!0),Y&&Y(L),g.i8(r)}})};
g.W.Ka=function(U){var Y=this,A,c,d,T,E,L,r,l,P,V,v,H;return g.S(function(G){switch(G.T){case 1:if(!Y.Y){mh(Y,"onMaybeTransferStreamsExpired");G.uY(2);break}return Y3m(Y)?g.x(G,gi(Y,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.x(G,Aaz(Y,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!Y.W){G.uY(2);break}A=Y.Y;d=((c=A)==null?0:c.key)?g.Uk(A.key).entityId:"";if(!d){G.uY(2);break}return g.x(G,Vs(d,Y.W,Y.T,"DOWNLOAD_STATE_FAILED"),2);case 9:return Y.Y||mh(Y,"onMaybeTransferStreamsExpiredRetryAttempting"),
T=Y.Y,L=((E=T)==null?0:E.key)?g.Uk(T.key).entityId:"",g.x(G,Om(Y,L),10);case 10:return r=G.Y,zn({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:L,sR:T,offlineModeType:r}),l=YAf(),g.OZ(l,fP,{isEnqueuedForExpiredStreamUrlRefetch:!0}),P=g.YX(L,"playbackData"),V={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:P,actionMetadata:l},v=wi(new Gn("playbackData",L,V)),g.x(G,u_(Y.T,v,"offlineOrchestrationActionWrapperEntity"),2);case 2:Qs(Y),H=Z9(Y,!0),
U&&U(H),g.i8(G)}})};
var EGm={},caj=(EGm.TRANSFER_STATE_TRANSFERRING=1,EGm.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,EGm);g.W=ys.prototype;g.W.oK=function(){return this.K.promise};
g.W.SR=function(){if(this.T&&this.G)return this.K.promise;E4o(this).then(this.K.resolve).catch(this.K.reject);return this.K.promise};
g.W.e3=function(U){var Y={};return Y.playbackData=new QMz(U,this.MI,this.Y),Y.transfer=new Eco(U,this.MI),Y.videoPlaybackPositionEntity=new Dvq(U,this.MI),Y};
g.W.Zx=function(){var U=this;return g.S(function(Y){return U.T?g.x(Y,OZY(U.T),0):Y.uY(0)})};
g.W.yk=function(){var U=this,Y,A;return g.S(function(c){if(c.T==1)return U.T||U.G?g.x(c,U.oK(),2):c.return();U.Z!==void 0&&(g.Wn(U.Z),U.Z=void 0);U.j!==void 0&&(g.Wn(U.j),U.j=void 0);(Y=U.T)==null||Y.dispose();U.T=void 0;(A=U.G)==null||A.dispose();U.G=void 0;U.api.Ev("onOrchestrationLostLeader");U.K=new g.VI;g.i8(c)})};
g.W.isOrchestrationLeader=function(){return this.W.Y};
g.W.Bz=function(){return g.S(function(U){return U.return(!1)})};
g.W.ix=function(U){var Y=this.Y;Y.api.publish("offlinetransferpause",U);var A;(A=Y.T)==null||A.postMessage(U)};
g.W.nj=function(U){var Y,A;return g.S(function(c){if(c.T==1)return g.x(c,Ct(),2);Y=c.Y;if(!Y)return c.return();A=g.YX(U,"transfer");return g.x(c,IA(Y,{mode:"readwrite",kt:!0},function(d){var T=Zv(d,A,"transfer"),E=Zv(d,g.YX(U,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.NC.all([T,E]).then(function(L){L=g.J(L);var r=L.next().value;var l=L.next().value;return r&&r.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(r.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",g0(d,r,"transfer").then(function(){zn({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:U,sR:r,offlineModeType:l==null?void 0:l.offlineModeType});return g.NC.resolve(null)})):g.NC.resolve(null)})}),0)})};
g.W.US=function(U){U=U===void 0?43200:U;var Y=this,A,c,d,T,E,L,r,l;return g.S(function(P){if(P.T==1)return Y.J.gY()?g.x(P,Ct(),2):P.return(o4T());if(P.T!=3){A=P.Y;if(!A)return P.return([]);c=Date.now()/1E3;return g.x(P,q$(A,"offlineVideoPolicy"),3)}d=P.Y;T=[];E=g.J(d);for(L=E.next();!L.done;L=E.next())r=L.value,Number(r.lastUpdatedTimestampSeconds)+U<=c&&(l=g.Uk(r.key).entityId,T.push(l));return T.length?P.return(nP(Y,T,Y.X,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):P.return([])})};
g.W.deleteAll=function(){return nP(this,["!*$_ALL_ENTITIES_!*$"],this.X,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.W.refreshAllStaleEntities=function(U){var Y=this;return g.S(function(A){return A.T==1?g.x(A,Y.US(U),2):A.return(A.Y)})};
g.W.setUpPositionSyncInterval=function(U){var Y=this;this.j!==void 0&&(g.Wn(this.j),this.j=void 0);var A=U!=null?U:864E5;this.j=g.Hn(function(){Y.O2(A)},A)};
g.W.O2=function(U){var Y=this,A,c,d,T,E,L;return g.S(function(r){switch(r.T){case 1:return g.J3(r,2),g.x(r,b_.getInstance(),4);case 4:A=r.Y;if(!A)throw Error("prefStorage is undefined");return g.x(r,A.get("psi"),5);case 5:c=r.Y;T=((d=c)==null?0:d.GJ)?Number(c.GJ)/1E3:0;E=Date.now();if(!(T+U<=E)){r.uY(6);break}return g.x(r,nP(Y,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.t3(r,0);break;case 2:L=g.XE(r),cQ("Offline manager error",L),
g.i8(r)}})};
g.W.B$=function(){var U=this,Y,A,c,d,T,E,L;return g.S(function(r){if(r.T==1)return g.x(r,Ct(),2);if(r.T!=3)return(Y=r.Y)?g.x(r,q$(Y,"transfer"),3):r.return([]);A=r.Y;c=[];d=g.J(A);for(T=d.next();!T.done;T=d.next())E=T.value,E.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&E.key&&(L=g.Uk(E.key).entityId,c.push(L));return r.return(LOz(U,c))})};
g.W.bV=function(){return g.S(function(U){return U.return([])})};
g.W.eC=function(){return g.S(function(U){g.i8(U)})};
g.W.p8=function(){return g.S(function(U){g.i8(U)})};g.w(raz,aI);raz.prototype.T=function(U){return ri(U)?VTm(this,U):l5(U)?v4w(this,U):PQ(U)?HFW(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};
var D9=[10];g.w(Jaq,aI);Jaq.prototype.T=function(U){return ri(U)?N5m(this,U):l5(U)?tTO(this,U):PQ(U)?eem(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};
var j5F=[10];g.w(XuY,aI);XuY.prototype.T=function(U){return l5(U)?ReI(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};g.w(aQT,ys);g.W=aQT.prototype;g.W.e3=function(U){var Y=ys.prototype.e3.call(this,U);Y.mainVideoEntity=new Jaq(U,this.MI,this.Y);Y.mainPlaylistEntity=new raz(U,this.MI,this.Y);Y.mainDownloadsListEntity=new XuY(U,this.MI,this.Y);return Y};
g.W.refreshAllStaleEntities=function(U,Y){var A=this,c,d,T,E,L,r,l,P,V,v,H;return g.S(function(G){switch(G.T){case 1:c=[];if(!A.MI.S("web_player_offline_playlist_auto_refresh")){G.uY(2);break}return g.x(G,xYo(A,U,Y),3);case 3:c=G.Y;case 2:return g.x(G,b_.getInstance(),4);case 4:return d=G.Y,g.x(G,(T=d)==null?void 0:T.get("sdois"),5);case 5:return E=G.Y,g.x(G,(L=d)==null?void 0:L.get("lmqf"),6);case 6:r=G.Y;if(!E){G.uY(7);break}P=c;V=P.concat;return g.x(G,s5z(A,E,(l=r)!=null?l:"SD",U===0),8);case 8:c=
V.call(P,G.Y);case 7:return v=c,H=v.concat,g.x(G,ys.prototype.refreshAllStaleEntities.call(A,U,Y),9);case 9:return c=H.call(v,G.Y),G.return(c)}})};
g.W.Bz=function(U){var Y,A,c,d,T,E,L,r;return g.S(function(l){if(l.T==1)return g.x(l,Ct(),2);if(l.T!=3)return(Y=l.Y)?g.x(l,Kt(Y,g.sL,"mainDownloadsListEntity"),3):l.return(!1);A=l.Y;if((c=A)==null?0:(d=c.downloads)==null?0:d.length)for(T=g.YX(U,"mainVideoEntity"),E=g.J(A.downloads),L=E.next();!L.done;L=E.next())if(r=L.value,r.videoItem===T)return l.return(!0);return l.return(!1)})};
g.W.bV=function(){var U=this,Y,A,c,d,T,E,L,r;return g.S(function(l){if(l.T==1)return g.x(l,Ct(),2);if(l.T!=3)return(Y=l.Y)?g.x(l,q$(Y,"downloadStatusEntity"),3):l.return([]);A=l.Y;c=[];d=g.J(A);for(T=d.next();!T.done;T=d.next())E=T.value,E.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&E.key&&(L=g.Uk(E.key).entityId,c.push(L));return c.length?(r={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},l.return(nP(U,c,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
r))):l.return([])})};
g.W.p8=function(){var U;return g.S(function(Y){return Y.T==1?g.x(Y,Ct(),2):(U=Y.Y)?g.x(Y,IA(U,{mode:"readwrite",kt:!0},function(A){return OK(A,"mainVideoEntity").then(function(c){var d=[];c=g.J(c);for(var T=c.next();!T.done;T=c.next()){T=T.value;var E=void 0;(E=T.userState)!=null&&E.playbackPosition||(E=g.Uk(T.key).entityId,E={key:g.YX(E,"videoPlaybackPositionEntity"),videoId:E,lastPlaybackPositionSeconds:"0"},d.push(g0(A,E,"videoPlaybackPositionEntity")),T.userState={playbackPosition:E.key},d.push(g0(A,
T,"mainVideoEntity")))}return g.NC.all(d)})}),0):Y.return()})};
g.W.eC=function(){var U,Y,A,c,d,T,E,L,r,l,P,V,v,H,G,F,N,e,B,f,h,Q,K,D,c3,TV,U9,LY,q,FE,B3,O9,tq,Lj,kl,eS,To,t;return g.S(function(zV){if(zV.T==1)return g.x(zV,Ct(),2);if(zV.T!=3){U=zV.Y;if(!U)return zV.return();Y=g.YX("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.x(zV,IA(U,{mode:"readonly",kt:!0},function(Im){return g.NC.all([Zv(Im,Y,"mainDownloadsListEntity"),Zv(Im,g.sL,"mainDownloadsListEntity"),OK(Im,"mainVideoEntity"),OK(Im,"mainPlaylistEntity")])}),3)}A=zV.Y;
c=g.J(A);d=c.next().value;T=c.next().value;E=c.next().value;L=c.next().value;r=d;l=T;P=E;V=L;v=new Set;if((H=r)==null?0:(G=H.downloads)==null?0:G.length)for(F=g.J(r.downloads),N=F.next();!N.done;N=F.next())e=N.value,B=void 0,(f=(B=e.videoItem)!=null?B:e.playlistItem)&&v.add(f);if((h=l)==null?0:(Q=h.downloads)==null?0:Q.length)for(K=g.J(l.downloads),D=K.next();!D.done;D=K.next())c3=D.value,c3.videoItem&&v.add(c3.videoItem);TV=new Set;U9=[];LY=g.J(V);for(q=LY.next();!q.done;q=LY.next()){FE=q.value;
if(FE.videos)for(B3=g.J(FE.videos),O9=B3.next();!O9.done;O9=B3.next())tq=O9.value,(Lj=JSON.parse(g.Uk(tq).entityId).videoId)&&TV.add(Lj);FE.key&&!v.has(FE.key)&&U9.push(FE.key)}kl=g.J(P);for(eS=kl.next();!eS.done;eS=kl.next())To=eS.value,To.key&&!v.has(To.key)&&(t=g.Uk(To.key).entityId,TV.has(t)||U9.push(To.key));return U9.length?g.x(zV,$vf(U,U9),0):zV.uY(0)})};g.w(fQI,aI);fQI.prototype.T=function(U){return ri(U)?S3f(this,U):l5(U)?MTw(this,U):PQ(U)?bFY(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};
var u5=[10];g.w(Q5L,aI);Q5L.prototype.T=function(U){return ri(U)?OFm(this,U):l5(U)?mYO(this,U):PQ(U)?g4Y(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};
var KP=[10];g.w(DYL,aI);DYL.prototype.T=function(U){return ri(U)?q3W(this,U):l5(U)?Cez(this,U):PQ(U)?ULz(this,U):Promise.reject(Error("Unsupported action type: "+U.actionType))};
var KOW=[10];g.w(qu,ys);qu.prototype.e3=function(U){var Y=ys.prototype.e3.call(this,U);Y.musicTrack=new DYL(U,this.Y);Y.musicPlaylist=new Q5L(U,this.Y);Y.musicAlbumRelease=new fQI(U,this.Y);return Y};
qu.prototype.refreshAllStaleEntities=function(U,Y){var A=this,c,d,T;return g.S(function(E){if(E.T==1)return g.x(E,AfT(A,U,Y),2);if(E.T!=3)return d=c=E.Y,T=d.concat,g.x(E,ys.prototype.refreshAllStaleEntities.call(A,U,Y),3);c=T.call(d,E.Y);return E.return(c)})};g.w(cfm,g.lj);g.W=cfm.prototype;g.W.create=function(){var U=this;g.Z(this,this.events);g.Cs(this.MI)?this.Y=new aQT(this.MI,this.player):g.pV(this.MI)&&(this.Y=new qu(this.MI,this.player));this.events.N(this.player,"onPlaybackStartExternal",function(){U.J5()});
this.events.N(this.player,"videodatachange",function(){U.J5()});
this.MI.S("html5_offline_playback_position_sync")&&this.events.N(this.player,"presentingplayerstatechange",this.Bs)};
g.W.Hi=function(){return!1};
g.W.TH=function(U,Y,A,c){var d=this;return g.S(function(T){return d.Y?T.return(nP(d.Y,U,Y,A,c)):T.return(Promise.reject())})};
g.W.deleteAll=function(){return this.Y.deleteAll()};
g.W.US=function(U){return this.Y.US(U)};
g.W.refreshAllStaleEntities=function(U){return this.Y.refreshAllStaleEntities(U)};
g.W.setUpPositionSyncInterval=function(U){this.Y.setUpPositionSyncInterval(U)};
g.W.ix=function(U){this.Y.ix(U)};
g.W.nj=function(U){return this.Y.nj(U)};
g.W.J5=function(){var U=this,Y;return g.S(function(A){Y=U.player.getVideoData();return g.Ip(Y)?dLq(Y)&&U.T!==Y.clientPlaybackNonce?g.x(A,TFL(U,Y),0):A.uY(0):A.return()})};
g.W.Bs=function(U){var Y=this,A,c,d,T,E,L,r;return g.S(function(l){if(l.T==1)return A=Y.player.getVideoData(),c=A.kE,g.Gg(U,2)||g.Gg(U,512)?g.x(l,Ct(),2):l.return();if(l.T!=3){d=l.Y;if(!d)return cQ("PES is undefined"),l.return();T=A.videoId;return g.x(l,Kt(d,g.YX(T,"mainVideoEntity"),"mainVideoEntity"),3)}E=l.Y;if(!E)return l.return();L=Math.floor(c).toString();r={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:L}};return g.x(l,Y.TH([T],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
r),0)})};
g.W.isOrchestrationLeader=function(){return this.Y.isOrchestrationLeader()};
g.W.updateDownloadState=function(U,Y){var A,c,d,T;return g.S(function(E){if(E.T==1)return g.x(E,Ct(),2);A=E.Y;if(!A)return cQ("PES is undefined"),E.return();c=g.Uk(U);d=c.entityType;T=c.entityId;return g.x(E,Vs(T,d,A,Y,!0),0)})};g.rH("offline",cfm);})(_yt_player);
